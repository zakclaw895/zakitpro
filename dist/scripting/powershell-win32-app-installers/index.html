<!DOCTYPE html><html lang="en" class="dark"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.18.0"><!-- Primary Meta Tags --><title>PowerShell Win32 App Installer Scripts | zakitpro</title><meta name="title" content="PowerShell Win32 App Installer Scripts | zakitpro"><meta name="description" content="Essential PowerShell scripts for installing and managing Win32 apps in Intune. Automate your app deployment workflow."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://zakitpro.com/scripting/powershell-win32-app-installers/"><meta property="og:title" content="PowerShell Win32 App Installer Scripts"><meta property="og:description" content="Essential PowerShell scripts for installing and managing Win32 apps in Intune. Automate your app deployment workflow."><meta property="og:site_name" content="zakitpro"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://zakitpro.com/scripting/powershell-win32-app-installers/"><meta property="twitter:title" content="PowerShell Win32 App Installer Scripts"><meta property="twitter:description" content="Essential PowerShell scripts for installing and managing Win32 apps in Intune. Automate your app deployment workflow."><!-- RSS --><link rel="alternate" type="application/rss+xml" title="zakitpro RSS Feed" href="/rss.xml"><!-- Theme Script - Blocks FOUC --><script>
      const theme = (() => {
        if (typeof localStorage !== 'undefined' && localStorage.getItem('zakitpro-theme')) {
          return localStorage.getItem('zakitpro-theme');
        }
        if (window.matchMedia('(prefers-color-scheme: light)').matches) {
          return 'light';
        }
        return 'dark';
      })();
      
      if (theme === 'light') {
        document.documentElement.classList.remove('dark');
      } else {
        document.documentElement.classList.add('dark');
      }
      window.localStorage.setItem('zakitpro-theme', theme);
    </script><link rel="stylesheet" href="/_astro/_slug_.CjjyHGGr.css">
<style>.prose pre{position:relative;margin:1.5rem 0;border-radius:.5rem;overflow:hidden}.prose pre code{font-family:JetBrains Mono,Consolas,monospace;font-size:.875rem;line-height:1.7}.prose pre[data-line-numbers]{counter-reset:line}.prose pre[data-line-numbers] .line:before{counter-increment:line;content:counter(line);display:inline-block;width:2rem;margin-right:1rem;text-align:right;color:#64748b;-webkit-user-select:none}.copy-btn{position:absolute;top:.5rem;right:.5rem;padding:.25rem .5rem;font-size:.75rem;background:#334155;color:#e2e8f0;border:none;border-radius:.25rem;cursor:pointer;opacity:0;transition:opacity .2s}.prose pre:hover .copy-btn{opacity:1}.lang-label{position:absolute;top:0;right:0;padding:.25rem .75rem;font-size:.75rem;font-weight:500;color:#94a3b8;background:#1e293b;border-bottom-left-radius:.5rem}
</style><script type="module" src="/_astro/page.CyD_eNI3.js"></script></head> <body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-200"> <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 focus:z-50 focus:px-4 focus:py-2 focus:bg-accent focus:text-white focus:rounded-md">
Skip to content
</a> <!-- Header --> <header class="sticky top-0 z-40 w-full bg-white/80 dark:bg-gray-900/80 backdrop-blur-md border-b border-gray-200 dark:border-gray-800 transition-all duration-300" id="header"> <div class="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between"> <!-- Logo --> <a href="/" class="flex items-center gap-2 font-heading font-bold text-xl text-gray-900 dark:text-white hover:text-accent transition-colors"> <svg class="w-8 h-8 text-accent" fill="currentColor" viewBox="0 0 24 24"> <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path> </svg> <span>zakitpro</span> </a> <!-- Desktop Nav --> <nav class="hidden md:flex items-center gap-6"> <div class="relative group"> <button class="flex items-center gap-1 text-gray-600 dark:text-gray-300 hover:text-accent transition-colors">
Pillars
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path> </svg> </button> <div class="absolute top-full left-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 py-2"> <a href="/troubleshooting/" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"> Windows Troubleshooting </a><a href="/scripting/" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"> Scripting &amp; Automation </a><a href="/deployment/" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"> Deployment &amp; Imaging </a><a href="/security/" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"> Endpoint Security </a><a href="/packaging/" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"> App Packaging </a><a href="/career/" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"> Career &amp; Craft </a> </div> </div> <a href="/scripts/" class="text-gray-600 dark:text-gray-300 hover:text-accent transition-colors">Scripts</a> <a href="/series/" class="text-gray-600 dark:text-gray-300 hover:text-accent transition-colors">Series</a> <a href="/error-codes/" class="text-gray-600 dark:text-gray-300 hover:text-accent transition-colors">Error Codes</a> <a href="/about/" class="text-gray-600 dark:text-gray-300 hover:text-accent transition-colors">About</a> </nav> <!-- Right Side --> <div class="flex items-center gap-3"> <!-- Search --> <button id="search-trigger" class="p-2 text-gray-600 dark:text-gray-300 hover:text-accent transition-colors" aria-label="Search"> <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path> </svg> </button> <!-- Theme Toggle --> <button id="theme-toggle" class="p-2 text-gray-600 dark:text-gray-300 hover:text-accent transition-colors" aria-label="Toggle theme"> <svg class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path> </svg> <svg class="w-5 h-5 block dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path> </svg> </button> <!-- Mobile Menu --> <button id="mobile-menu-btn" class="md:hidden p-2 text-gray-600 dark:text-gray-300" aria-label="Menu"> <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path> </svg> </button> </div> </div> <!-- Mobile Menu --> <div id="mobile-menu" class="hidden md:hidden bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800"> <nav class="max-w-6xl mx-auto px-4 py-4 flex flex-col gap-2"> <span class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Pillars</span> <a href="/troubleshooting/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"> Windows Troubleshooting </a><a href="/scripting/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"> Scripting &amp; Automation </a><a href="/deployment/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"> Deployment &amp; Imaging </a><a href="/security/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"> Endpoint Security </a><a href="/packaging/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"> App Packaging </a><a href="/career/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"> Career &amp; Craft </a> <hr class="my-2 border-gray-200 dark:border-gray-700"> <a href="/scripts/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg">Scripts</a> <a href="/series/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg">Series</a> <a href="/error-codes/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg">Error Codes</a> <a href="/about/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg">About</a> </nav> </div> </header> <!-- Main Content --> <main id="main-content" class="min-h-screen">  <div class="max-w-7xl mx-auto px-4 py-8"> <!-- Breadcrumb --> <nav class="flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 mb-6"> <a href="/" class="hover:text-accent">Home</a> <span>/</span> <a href="/scripting/" class="hover:text-accent">Scripting &amp; Automation</a> <span>/</span> <span class="text-gray-900 dark:text-white">PowerShell Win32 App Installer Scripts</span> </nav> <div class="lg:grid lg:grid-cols-4 lg:gap-8"> <!-- Left Sidebar - Table of Contents (Desktop) --> <aside class="hidden lg:block lg:col-span-1"> <div class="sticky top-24"> <nav class="text-sm"> <h4 class="font-semibold mb-3 text-gray-900 dark:text-white">On this page</h4> <ul class="space-y-2"> <li class> <a href="#script-1-silent-install-wrapper" class="text-gray-600 dark:text-gray-400 hover:text-accent transition-colors block py-1"> Script 1: Silent Install Wrapper </a> </li><li class> <a href="#script-2-detection-rule-generator" class="text-gray-600 dark:text-gray-400 hover:text-accent transition-colors block py-1"> Script 2: Detection Rule Generator </a> </li><li class> <a href="#script-3-pre-install-system-check" class="text-gray-600 dark:text-gray-400 hover:text-accent transition-colors block py-1"> Script 3: Pre-Install System Check </a> </li><li class> <a href="#script-4-uninstall-legacy-app" class="text-gray-600 dark:text-gray-400 hover:text-accent transition-colors block py-1"> Script 4: Uninstall Legacy App </a> </li><li class> <a href="#script-5-post-install-validation" class="text-gray-600 dark:text-gray-400 hover:text-accent transition-colors block py-1"> Script 5: Post-Install Validation </a> </li><li class> <a href="#wrap-up" class="text-gray-600 dark:text-gray-400 hover:text-accent transition-colors block py-1"> Wrap-Up </a> </li> </ul> </nav> </div> </aside> <!-- Main Content --> <article class="lg:col-span-2"> <!-- Article Header --> <header class="mb-8"> <div class="flex flex-wrap items-center gap-3 mb-4"> <span class="text-sm text-gray-600 dark:text-gray-400"> February 26, 2026 </span> <span class="text-gray-400">•</span> <span class="inline-block px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"> Mid-Level (3-5 years) </span> <span class="px-2 py-1 text-xs font-medium rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"> Script Drop </span> </div> <h1 class="text-3xl md:text-4xl font-heading font-bold mb-4">PowerShell Win32 App Installer Scripts</h1> <p class="text-lg text-gray-600 dark:text-gray-400">Essential PowerShell scripts for installing and managing Win32 apps in Intune. Automate your app deployment workflow.</p>  </header> <!-- Article Content --> <div class="prose dark:prose-invert max-w-none"> <h1 id="powershell-win32-app-installer-scripts">PowerShell Win32 App Installer Scripts</h1>
<p>Deploying Win32 apps in Intune is powerful but can be tricky. These scripts will help you package, install, and troubleshoot Win32 applications like a pro.</p>
<h2 id="script-1-silent-install-wrapper">Script 1: Silent Install Wrapper</h2>
<p>Every Win32 app needs a silent install. This wrapper handles the most common scenarios:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#6A737D">&lt;#</span></span>
<span class="line"><span style="color:#79B8FF">.</span><span style="color:#F97583">SYNOPSIS</span></span>
<span class="line"><span style="color:#6A737D">    Universal silent installer wrapper for Win32 apps</span></span>
<span class="line"><span style="color:#6A737D">    </span></span>
<span class="line"><span style="color:#79B8FF">.</span><span style="color:#F97583">PARAMETER</span><span style="color:#F97583"> InstallerPath</span></span>
<span class="line"><span style="color:#6A737D">    Full path to the installer file</span></span>
<span class="line"><span style="color:#6A737D">    </span></span>
<span class="line"><span style="color:#79B8FF">.</span><span style="color:#F97583">PARAMETER</span><span style="color:#F97583"> Arguments</span></span>
<span class="line"><span style="color:#6A737D">    Silent install arguments</span></span>
<span class="line"><span style="color:#6A737D">    </span></span>
<span class="line"><span style="color:#79B8FF">.</span><span style="color:#F97583">PARAMETER</span><span style="color:#F97583"> ExpectedExitCode</span></span>
<span class="line"><span style="color:#6A737D">    Expected exit code on success (default: 0)</span></span>
<span class="line"><span style="color:#6A737D">#&gt;</span></span>
<span class="line"><span style="color:#F97583">param</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#79B8FF">Parameter</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">Mandatory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">$true</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#F97583">string</span><span style="color:#E1E4E8">]$InstallerPath</span><span style="color:#F97583">,</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#79B8FF">Parameter</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">Mandatory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">$false</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#F97583">string</span><span style="color:#E1E4E8">]$Arguments </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> &quot;/S&quot;</span><span style="color:#F97583">,</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#79B8FF">Parameter</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">Mandatory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">$false</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#F97583">int</span><span style="color:#E1E4E8">]$ExpectedExitCode </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">$ErrorActionPreference</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> &quot;Stop&quot;</span></span>
<span class="line"><span style="color:#E1E4E8">$LogFile </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> &quot;</span><span style="color:#E1E4E8">$</span><span style="color:#79B8FF">env:</span><span style="color:#E1E4E8">TEMP</span><span style="color:#9ECBFF">\Win32Install_</span><span style="color:#F97583">$</span><span style="color:#9ECBFF">(</span><span style="color:#79B8FF">Get-Date</span><span style="color:#F97583"> -</span><span style="color:#9ECBFF">Format </span><span style="color:#9ECBFF">&#39;yyyyMMdd_HHmmss&#39;</span><span style="color:#9ECBFF">)</span><span style="color:#9ECBFF">.log&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">function</span><span style="color:#B392F0"> Write-Log</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    param</span><span style="color:#E1E4E8">([</span><span style="color:#F97583">string</span><span style="color:#E1E4E8">]$Message)</span></span>
<span class="line"><span style="color:#E1E4E8">    $Timestamp </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> Get-Date</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">Format </span><span style="color:#9ECBFF">&#39;yyyy-MM-dd HH:mm:ss&#39;</span></span>
<span class="line"><span style="color:#E1E4E8">    $LogMessage </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> &quot;[</span><span style="color:#E1E4E8">$Timestamp</span><span style="color:#9ECBFF">] </span><span style="color:#E1E4E8">$Message</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"><span style="color:#79B8FF">    Write-Host</span><span style="color:#E1E4E8"> $LogMessage</span></span>
<span class="line"><span style="color:#79B8FF">    Add-Content</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">Path $LogFile </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">Value $LogMessage</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">Write-Log</span><span style="color:#9ECBFF"> &quot;Starting installation: </span><span style="color:#E1E4E8">$InstallerPath</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"><span style="color:#79B8FF">Write-Log</span><span style="color:#9ECBFF"> &quot;Arguments: </span><span style="color:#E1E4E8">$Arguments</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">try</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    $Process </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> Start-Process</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">FilePath $InstallerPath </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">ArgumentList $Arguments </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">Wait </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">PassThru </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">NoNewWindow</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> ($Process.ExitCode </span><span style="color:#F97583">-eq</span><span style="color:#E1E4E8"> $ExpectedExitCode) {</span></span>
<span class="line"><span style="color:#79B8FF">        Write-Log</span><span style="color:#9ECBFF"> &quot;SUCCESS: Installation completed with exit code </span><span style="color:#F97583">$</span><span style="color:#9ECBFF">(</span><span style="color:#E1E4E8">$Process.ExitCode</span><span style="color:#9ECBFF">)</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"><span style="color:#F97583">        exit</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">    } </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">        Write-Log</span><span style="color:#9ECBFF"> &quot;WARNING: Installation completed with unexpected exit code </span><span style="color:#F97583">$</span><span style="color:#9ECBFF">(</span><span style="color:#E1E4E8">$Process.ExitCode</span><span style="color:#9ECBFF">)</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"><span style="color:#F97583">        exit</span><span style="color:#E1E4E8"> $Process.ExitCode</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"><span style="color:#F97583">catch</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">    Write-Log</span><span style="color:#9ECBFF"> &quot;ERROR: </span><span style="color:#F97583">$</span><span style="color:#9ECBFF">(</span><span style="color:#79B8FF">$_</span><span style="color:#E1E4E8">.Exception.Message</span><span style="color:#9ECBFF">)</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"><span style="color:#F97583">    exit</span><span style="color:#79B8FF"> 1</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p><strong>Usage:</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">\Install-App.ps1</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">InstallerPath </span><span style="color:#9ECBFF">&quot;C:\Apps\7zip\7zip-x64.msi&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">Arguments </span><span style="color:#9ECBFF">&quot;/quiet /norestart&quot;</span></span></code></pre>
<h2 id="script-2-detection-rule-generator">Script 2: Detection Rule Generator</h2>
<p>Create detection rules for your Win32 apps automatically:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#6A737D">&lt;#</span></span>
<span class="line"><span style="color:#79B8FF">.</span><span style="color:#F97583">SYNOPSIS</span></span>
<span class="line"><span style="color:#6A737D">    Generate Intune detection rules for Win32 apps</span></span>
<span class="line"><span style="color:#6A737D">#&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">param</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#79B8FF">Parameter</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">Mandatory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">$true</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#F97583">string</span><span style="color:#E1E4E8">]$AppName</span><span style="color:#F97583">,</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#79B8FF">Parameter</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">Mandatory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">$false</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#79B8FF">ValidateSet</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;File&quot;</span><span style="color:#F97583">,</span><span style="color:#9ECBFF"> &quot;Registry&quot;</span><span style="color:#F97583">,</span><span style="color:#9ECBFF"> &quot;MSI&quot;</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#F97583">string</span><span style="color:#E1E4E8">]$DetectionType </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> &quot;File&quot;</span><span style="color:#F97583">,</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#79B8FF">Parameter</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">Mandatory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">$true</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#F97583">string</span><span style="color:#E1E4E8">]$DetectionPath</span><span style="color:#F97583">,</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#79B8FF">Parameter</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">Mandatory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">$false</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#F97583">string</span><span style="color:#E1E4E8">]$DetectionVersion</span></span>
<span class="line"><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">$Rule </span><span style="color:#F97583">=</span><span style="color:#F97583"> @</span><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;@odata.type&quot;</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> &quot;#microsoft.graph.win32LobAppDetectionRule&quot;</span></span>
<span class="line"><span style="color:#E1E4E8">    ruleType </span><span style="color:#F97583">=</span><span style="color:#F97583"> switch</span><span style="color:#E1E4E8"> ($DetectionType) {</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;File&quot;</span><span style="color:#E1E4E8"> { </span><span style="color:#9ECBFF">&quot;file&quot;</span><span style="color:#E1E4E8"> }</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;Registry&quot;</span><span style="color:#E1E4E8"> { </span><span style="color:#9ECBFF">&quot;registry&quot;</span><span style="color:#E1E4E8"> }</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;MSI&quot;</span><span style="color:#E1E4E8"> { </span><span style="color:#9ECBFF">&quot;productVersion&quot;</span><span style="color:#E1E4E8"> }</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">    path </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> $DetectionPath</span></span>
<span class="line"><span style="color:#E1E4E8">    fileOrFolderName </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> Split-Path</span><span style="color:#E1E4E8"> $DetectionPath </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">Leaf</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">if</span><span style="color:#E1E4E8"> ($DetectionVersion) {</span></span>
<span class="line"><span style="color:#E1E4E8">    $Rule[</span><span style="color:#9ECBFF">&quot;version&quot;</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> $DetectionVersion</span></span>
<span class="line"><span style="color:#E1E4E8">    $Rule[</span><span style="color:#9ECBFF">&quot;operator&quot;</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> &quot;greaterThanOrEqual&quot;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">$DetectionRule </span><span style="color:#F97583">=</span><span style="color:#F97583"> @</span><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#E1E4E8">    rules </span><span style="color:#F97583">=</span><span style="color:#F97583"> @</span><span style="color:#E1E4E8">($Rule)</span></span>
<span class="line"><span style="color:#E1E4E8">} </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> ConvertTo-Json</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">Depth </span><span style="color:#79B8FF">5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">Write-Output</span><span style="color:#E1E4E8"> $DetectionRule</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Save to file for Intune Win32 import</span></span>
<span class="line"><span style="color:#E1E4E8">$DetectionRule </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> Out-File</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">FilePath </span><span style="color:#9ECBFF">&quot;.\</span><span style="color:#E1E4E8">$AppName</span><span style="color:#9ECBFF">-detection-rule.json&quot;</span></span>
<span class="line"><span style="color:#79B8FF">Write-Host</span><span style="color:#9ECBFF"> &quot;Detection rule saved to .\</span><span style="color:#E1E4E8">$AppName</span><span style="color:#9ECBFF">-detection-rule.json&quot;</span></span></code></pre>
<h2 id="script-3-pre-install-system-check">Script 3: Pre-Install System Check</h2>
<p>Check prerequisites before installing:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#6A737D">&lt;#</span></span>
<span class="line"><span style="color:#79B8FF">.</span><span style="color:#F97583">SYNOPSIS</span></span>
<span class="line"><span style="color:#6A737D">    Pre-installation system checks for Win32 apps</span></span>
<span class="line"><span style="color:#6A737D">#&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">$ErrorActionPreference</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> &quot;Continue&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">Write-Host</span><span style="color:#9ECBFF"> &quot;=== System Prerequisites Check ===&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor Cyan</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">$Checks </span><span style="color:#F97583">=</span><span style="color:#F97583"> @</span><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;Disk Space (C:)&quot;</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">        $Drive </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> Get-PSDrive</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">Name C</span></span>
<span class="line"><span style="color:#E1E4E8">        [</span><span style="color:#F97583">math</span><span style="color:#E1E4E8">]::Round($Drive.Free </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583">GB,</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;OS Version&quot;</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">        (</span><span style="color:#79B8FF">Get-CimInstance</span><span style="color:#E1E4E8"> Win32_OperatingSystem).Caption</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;Architecture&quot;</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">        $</span><span style="color:#79B8FF">env:</span><span style="color:#E1E4E8">PROCESSOR_ARCHITECTURE</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;Intune Agent Version&quot;</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">        (</span><span style="color:#79B8FF">Get-ItemProperty</span><span style="color:#9ECBFF"> &quot;HKLM:\SOFTWARE\Microsoft\IntuneAgent&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ErrorAction SilentlyContinue).Version</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;PowerShell Version&quot;</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">        $PSVersionTable</span><span style="color:#E1E4E8">.PSVersion.ToString()</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;Free RAM (GB)&quot;</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">        [</span><span style="color:#F97583">math</span><span style="color:#E1E4E8">]::Round((</span><span style="color:#79B8FF">Get-CimInstance</span><span style="color:#E1E4E8"> Win32_OperatingSystem).FreePhysicalMemory </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583">MB,</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">$AllPassed </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> $true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">foreach</span><span style="color:#E1E4E8"> ($Check </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> $Checks.GetEnumerator()) {</span></span>
<span class="line"><span style="color:#E1E4E8">    $Result </span><span style="color:#F97583">=</span><span style="color:#F97583"> &amp;</span><span style="color:#E1E4E8"> $Check.Value</span></span>
<span class="line"><span style="color:#E1E4E8">    $Status </span><span style="color:#F97583">=</span><span style="color:#F97583"> if</span><span style="color:#E1E4E8"> ($Result) { </span><span style="color:#9ECBFF">&quot;✓ PASS&quot;</span><span style="color:#E1E4E8"> } </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> { </span><span style="color:#9ECBFF">&quot;✗ FAIL&quot;</span><span style="color:#E1E4E8"> }</span></span>
<span class="line"><span style="color:#E1E4E8">    $Color </span><span style="color:#F97583">=</span><span style="color:#F97583"> if</span><span style="color:#E1E4E8"> ($Result) { </span><span style="color:#9ECBFF">&quot;Green&quot;</span><span style="color:#E1E4E8"> } </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> { </span><span style="color:#9ECBFF">&quot;Red&quot;</span><span style="color:#E1E4E8"> }</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#79B8FF">    Write-Host</span><span style="color:#9ECBFF"> &quot;</span><span style="color:#F97583">$</span><span style="color:#9ECBFF">(</span><span style="color:#E1E4E8">$Check.Key</span><span style="color:#9ECBFF">)</span><span style="color:#9ECBFF">: </span><span style="color:#E1E4E8">$Result</span><span style="color:#9ECBFF"> - </span><span style="color:#E1E4E8">$Status</span><span style="color:#9ECBFF">&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor $Color</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">-not</span><span style="color:#E1E4E8"> $Result </span><span style="color:#F97583">-and</span><span style="color:#E1E4E8"> $Check.Key </span><span style="color:#F97583">-ne</span><span style="color:#9ECBFF"> &quot;Free RAM (GB)&quot;</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">        $AllPassed </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> $false</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">if</span><span style="color:#E1E4E8"> ($AllPassed) {</span></span>
<span class="line"><span style="color:#79B8FF">    Write-Host</span><span style="color:#9ECBFF"> &quot;</span><span style="color:#79B8FF">`n</span><span style="color:#9ECBFF">All checks passed!&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor Green</span></span>
<span class="line"><span style="color:#F97583">    exit</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">} </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">    Write-Host</span><span style="color:#9ECBFF"> &quot;</span><span style="color:#79B8FF">`n</span><span style="color:#9ECBFF">Some checks failed!&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor Red</span></span>
<span class="line"><span style="color:#F97583">    exit</span><span style="color:#79B8FF"> 1</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="script-4-uninstall-legacy-app">Script 4: Uninstall Legacy App</h2>
<p>Clean up old versions before installing new:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#6A737D">&lt;#</span></span>
<span class="line"><span style="color:#79B8FF">.</span><span style="color:#F97583">SYNOPSIS</span></span>
<span class="line"><span style="color:#6A737D">    Uninstall existing versions of an application</span></span>
<span class="line"><span style="color:#6A737D">#&gt;</span></span>
<span class="line"><span style="color:#F97583">param</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#79B8FF">Parameter</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">Mandatory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">$true</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#F97583">string</span><span style="color:#E1E4E8">]$AppName</span><span style="color:#F97583">,</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#79B8FF">Parameter</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">Mandatory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">$false</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#F97583">string</span><span style="color:#E1E4E8">[]]$UninstallStrings</span></span>
<span class="line"><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">$ErrorActionPreference</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> &quot;Continue&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">Write-Host</span><span style="color:#9ECBFF"> &quot;Searching for existing </span><span style="color:#E1E4E8">$AppName</span><span style="color:#9ECBFF"> installations...&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor Yellow</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">$InstalledApps </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> Get-ItemProperty</span><span style="color:#E1E4E8"> HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\</span><span style="color:#F97583">*,</span></span>
<span class="line"><span style="color:#E1E4E8">    HKLM:\Software\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\</span><span style="color:#F97583">*</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ErrorAction SilentlyContinue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">$FoundApps </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> $InstalledApps </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> Where-Object</span><span style="color:#E1E4E8"> { </span><span style="color:#79B8FF">$_</span><span style="color:#E1E4E8">.DisplayName </span><span style="color:#F97583">-like</span><span style="color:#9ECBFF"> &quot;*</span><span style="color:#E1E4E8">$AppName</span><span style="color:#9ECBFF">*&quot;</span><span style="color:#E1E4E8"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">if</span><span style="color:#E1E4E8"> ($FoundApps) {</span></span>
<span class="line"><span style="color:#F97583">    foreach</span><span style="color:#E1E4E8"> ($App </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> $FoundApps) {</span></span>
<span class="line"><span style="color:#79B8FF">        Write-Host</span><span style="color:#9ECBFF"> &quot;Found: </span><span style="color:#F97583">$</span><span style="color:#9ECBFF">(</span><span style="color:#E1E4E8">$App.DisplayName</span><span style="color:#9ECBFF">)</span><span style="color:#9ECBFF"> - </span><span style="color:#F97583">$</span><span style="color:#9ECBFF">(</span><span style="color:#E1E4E8">$App.Version</span><span style="color:#9ECBFF">)</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"><span style="color:#E1E4E8">        </span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> ($App.UninstallString) {</span></span>
<span class="line"><span style="color:#79B8FF">            Write-Host</span><span style="color:#9ECBFF"> &quot;Uninstalling...&quot;</span></span>
<span class="line"><span style="color:#E1E4E8">            </span></span>
<span class="line"><span style="color:#E1E4E8">            $UninstallString </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> $App.UninstallString</span></span>
<span class="line"><span style="color:#E1E4E8">            </span></span>
<span class="line"><span style="color:#6A737D">            # Handle different uninstall formats</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> ($UninstallString </span><span style="color:#F97583">-match</span><span style="color:#9ECBFF"> &quot;msiexec&quot;</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">                $UninstallString </span><span style="color:#F97583">+=</span><span style="color:#9ECBFF"> &quot; /qn /norestart&quot;</span></span>
<span class="line"><span style="color:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#E1E4E8">            </span></span>
<span class="line"><span style="color:#79B8FF">            Start-Process</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">FilePath </span><span style="color:#9ECBFF">&quot;cmd.exe&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ArgumentList </span><span style="color:#9ECBFF">&quot;/c </span><span style="color:#F97583">$</span><span style="color:#9ECBFF">(</span><span style="color:#E1E4E8">$UninstallString</span><span style="color:#9ECBFF">)</span><span style="color:#9ECBFF">&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">Wait </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">NoNewWindow</span></span>
<span class="line"><span style="color:#79B8FF">            Write-Host</span><span style="color:#9ECBFF"> &quot;Uninstalled successfully&quot;</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">} </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">    Write-Host</span><span style="color:#9ECBFF"> &quot;No existing installations found&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor Green</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="script-5-post-install-validation">Script 5: Post-Install Validation</h2>
<p>Verify the app installed correctly:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#6A737D">&lt;#</span></span>
<span class="line"><span style="color:#79B8FF">.</span><span style="color:#F97583">SYNOPSIS</span></span>
<span class="line"><span style="color:#6A737D">    Post-installation validation</span></span>
<span class="line"><span style="color:#6A737D">#&gt;</span></span>
<span class="line"><span style="color:#F97583">param</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#79B8FF">Parameter</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">Mandatory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">$true</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#F97583">string</span><span style="color:#E1E4E8">]$AppName</span><span style="color:#F97583">,</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#79B8FF">Parameter</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">Mandatory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">$false</span><span style="color:#E1E4E8">)]</span></span>
<span class="line"><span style="color:#E1E4E8">    [</span><span style="color:#F97583">string</span><span style="color:#E1E4E8">[]]$VerificationPaths</span></span>
<span class="line"><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">Write-Host</span><span style="color:#9ECBFF"> &quot;Validating </span><span style="color:#E1E4E8">$AppName</span><span style="color:#9ECBFF"> installation...&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor Cyan</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">$ValidationPassed </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> $true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">foreach</span><span style="color:#E1E4E8"> ($Path </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> $VerificationPaths) {</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">Test-Path</span><span style="color:#E1E4E8"> $Path) {</span></span>
<span class="line"><span style="color:#79B8FF">        Write-Host</span><span style="color:#9ECBFF"> &quot;✓ Found: </span><span style="color:#E1E4E8">$Path</span><span style="color:#9ECBFF">&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor Green</span></span>
<span class="line"><span style="color:#E1E4E8">    } </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">        Write-Host</span><span style="color:#9ECBFF"> &quot;✗ Missing: </span><span style="color:#E1E4E8">$Path</span><span style="color:#9ECBFF">&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor Red</span></span>
<span class="line"><span style="color:#E1E4E8">        $ValidationPassed </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> $false</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Check registry</span></span>
<span class="line"><span style="color:#E1E4E8">$RegPath </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> &quot;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\*&quot;</span></span>
<span class="line"><span style="color:#E1E4E8">$RegApps </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> Get-ItemProperty</span><span style="color:#E1E4E8"> $RegPath </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">ErrorAction SilentlyContinue </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> Where-Object</span><span style="color:#E1E4E8"> { </span><span style="color:#79B8FF">$_</span><span style="color:#E1E4E8">.DisplayName </span><span style="color:#F97583">-like</span><span style="color:#9ECBFF"> &quot;*</span><span style="color:#E1E4E8">$AppName</span><span style="color:#9ECBFF">*&quot;</span><span style="color:#E1E4E8"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">if</span><span style="color:#E1E4E8"> ($RegApps) {</span></span>
<span class="line"><span style="color:#79B8FF">    Write-Host</span><span style="color:#9ECBFF"> &quot;✓ Registry entry found&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor Green</span></span>
<span class="line"><span style="color:#E1E4E8">} </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">    Write-Host</span><span style="color:#9ECBFF"> &quot;⚠ No registry entry (may be normal)&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor Yellow</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">if</span><span style="color:#E1E4E8"> ($ValidationPassed) {</span></span>
<span class="line"><span style="color:#79B8FF">    Write-Host</span><span style="color:#9ECBFF"> &quot;</span><span style="color:#79B8FF">`n</span><span style="color:#9ECBFF">✓ Validation PASSED&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor Green</span></span>
<span class="line"><span style="color:#F97583">    exit</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">} </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#79B8FF">    Write-Host</span><span style="color:#9ECBFF"> &quot;</span><span style="color:#79B8FF">`n</span><span style="color:#9ECBFF">✗ Validation FAILED&quot;</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">ForegroundColor Red</span></span>
<span class="line"><span style="color:#F97583">    exit</span><span style="color:#79B8FF"> 1</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="wrap-up">Wrap-Up</h2>
<p>These scripts cover the full Win32 app lifecycle in Intune. Save them to your toolkit and customize for each app deployment.</p> </div> <!-- Tags --> <div class="mt-8 pt-8 border-t border-gray-200 dark:border-gray-700"> <div class="flex flex-wrap gap-2"> <a href="/tags/powershell" class="px-3 py-1 text-sm bg-gray-100 dark:bg-gray-800 rounded-full text-gray-700 dark:text-gray-300 hover:bg-accent hover:text-white transition-colors">
#powershell </a><a href="/tags/intune" class="px-3 py-1 text-sm bg-gray-100 dark:bg-gray-800 rounded-full text-gray-700 dark:text-gray-300 hover:bg-accent hover:text-white transition-colors">
#intune </a><a href="/tags/win32" class="px-3 py-1 text-sm bg-gray-100 dark:bg-gray-800 rounded-full text-gray-700 dark:text-gray-300 hover:bg-accent hover:text-white transition-colors">
#win32 </a><a href="/tags/app-deployment" class="px-3 py-1 text-sm bg-gray-100 dark:bg-gray-800 rounded-full text-gray-700 dark:text-gray-300 hover:bg-accent hover:text-white transition-colors">
#app-deployment </a><a href="/tags/automation" class="px-3 py-1 text-sm bg-gray-100 dark:bg-gray-800 rounded-full text-gray-700 dark:text-gray-300 hover:bg-accent hover:text-white transition-colors">
#automation </a> </div> </div> <!-- Was this helpful? --> <div class="mt-8 flex items-center gap-4"> <span class="text-sm text-gray-600 dark:text-gray-400">Was this helpful?</span> <button class="flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
👍 Yes
</button> <button class="flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
👎 No
</button> </div> <!-- Giscus Comments --> <div class="mt-12 pt-8 border-t border-gray-200 dark:border-gray-700"> <script src="https://giscus.app/client.js" data-repo="your-username/zakitpro-comments" data-repo-id="YOUR_REPO_ID" data-category="Comments" data-category-id="YOUR_CATEGORY_ID" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="en" crossorigin="anonymous" async>
          </script> </div> </article> <!-- Right Sidebar - Metadata (Desktop) --> <aside class="hidden lg:block lg:col-span-1"> <div class="sticky top-24 space-y-6"> <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4"> <h4 class="text-xs font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400 mb-2">Pillar</h4> <a href="/scripting/" class="text-accent hover:underline font-medium"> Scripting &amp; Automation </a> </div> <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4"> <h4 class="text-xs font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400 mb-2">Difficulty</h4> <span class="inline-block px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"> Mid-Level (3-5 years) </span> </div> <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4"> <h4 class="text-xs font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400 mb-2">Published</h4> <p class="text-sm text-gray-700 dark:text-gray-300"> February 26, 2026 </p> </div> </div> </aside> </div> </div>  </main> <!-- Footer --> <footer class="bg-gray-100 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-16"> <div class="max-w-6xl mx-auto px-4 py-12"> <div class="grid grid-cols-2 md:grid-cols-4 gap-8 mb-8"> <div> <h3 class="font-heading font-bold text-lg mb-4">zakitpro</h3> <p class="text-sm text-gray-600 dark:text-gray-400">IT Desktop Engineering Blog</p> </div> <div> <h4 class="font-semibold mb-4">Pillars</h4> <ul class="space-y-2 text-sm"> <li><a href="/troubleshooting/" class="text-gray-600 dark:text-gray-400 hover:text-accent">Windows Troubleshooting</a></li><li><a href="/scripting/" class="text-gray-600 dark:text-gray-400 hover:text-accent">Scripting &amp; Automation</a></li><li><a href="/deployment/" class="text-gray-600 dark:text-gray-400 hover:text-accent">Deployment &amp; Imaging</a></li><li><a href="/security/" class="text-gray-600 dark:text-gray-400 hover:text-accent">Endpoint Security</a></li><li><a href="/packaging/" class="text-gray-600 dark:text-gray-400 hover:text-accent">App Packaging</a></li><li><a href="/career/" class="text-gray-600 dark:text-gray-400 hover:text-accent">Career &amp; Craft</a></li> </ul> </div> <div> <h4 class="font-semibold mb-4">Content</h4> <ul class="space-y-2 text-sm"> <li><a href="/scripts/" class="text-gray-600 dark:text-gray-400 hover:text-accent">Scripts</a></li> <li><a href="/series/" class="text-gray-600 dark:text-gray-400 hover:text-accent">Series</a></li> <li><a href="/error-codes/" class="text-gray-600 dark:text-gray-400 hover:text-accent">Error Codes</a></li> <li><a href="/about/" class="text-gray-600 dark:text-gray-400 hover:text-accent">About</a></li> </ul> </div> <div> <h4 class="font-semibold mb-4">Subscribe</h4> <ul class="space-y-2 text-sm"> <li><a href="/rss.xml" class="text-gray-600 dark:text-gray-400 hover:text-accent">RSS Feed</a></li> </ul> </div> </div> <div class="pt-8 border-t border-gray-200 dark:border-gray-700 flex flex-col md:flex-row justify-between items-center gap-4"> <p class="text-sm text-gray-600 dark:text-gray-400">No ads. No tracking. No fluff.</p> <p class="text-sm text-gray-600 dark:text-gray-400">© 2026 zakitpro. All rights reserved.</p> </div> </div> </footer> <!-- Theme Toggle Script --> <script type="module">const t=document.getElementById("theme-toggle");t?.addEventListener("click",()=>{document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("zakitpro-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("zakitpro-theme","dark"))});const n=document.getElementById("mobile-menu-btn"),m=document.getElementById("mobile-menu");n?.addEventListener("click",()=>{m?.classList.toggle("hidden")});document.addEventListener("keydown",e=>{(e.metaKey||e.ctrlKey)&&e.key==="k"&&(e.preventDefault(),document.getElementById("search-trigger")?.click())});</script>  </body> </html> 