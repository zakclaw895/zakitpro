[["Map",1,2,9,10,402,403],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.18.0","content-config-digest","51663c9a30901674","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://zakitpro.com\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"prefetch\":{\"defaultStrategy\":\"viewport\"},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true,\"allowedDomains\":[],\"actionBodySizeLimit\":1048576},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false,\"failOnPrerenderConflict\":false,\"svgo\":false},\"legacy\":{\"collections\":false}}","articles",["Map",11,12,32,33,49,50,64,65,79,80,95,96,109,110,121,122,135,136,148,149,160,161,172,173,184,185,198,199,211,212,223,224,237,238,251,252,263,264,276,277,288,289,301,302,314,315,324,325,336,337,352,353,363,364,376,377,389,390],"active-directory-group-management",{"id":11,"data":13,"body":27,"filePath":28,"digest":29,"legacyId":30,"deferredRender":31},{"title":14,"description":15,"publishedAt":16,"pillar":17,"difficulty":18,"type":19,"tags":20,"draft":26},"Active Directory Group Management Scripts","PowerShell scripts for managing Active Directory groups. Add/remove members, create groups, and bulk operations.","2026-02-27","scripting","junior","script-drop",[21,22,23,24,25],"powershell","active-directory","groups","security-groups","script",false,"# Active Directory Group Management Scripts\n\nManaging AD groups is a daily task. These scripts make it fast and consistent.\n\n## Add User to Group\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Add user to security group\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$Username,\n    \n    [Parameter(Mandatory=$true)]\n    [string]$GroupName\n)\n\ntry {\n    Add-ADGroupMember -Identity $GroupName -Members $Username -ErrorAction Stop\n    Write-Host \"Added $Username to $GroupName\" -ForegroundColor Green\n}\ncatch {\n    Write-Host \"Error: $($_.Exception.Message)\" -ForegroundColor Red\n}\n```\n\n## Remove User from Group\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Remove user from group\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$Username,\n    \n    [Parameter(Mandatory=$true)]\n    [string]$GroupName\n)\n\nRemove-ADGroupMember -Identity $GroupName -Members $Username -Confirm:$false\nWrite-Host \"Removed $Username from $GroupName\"\n```\n\n## List Group Members\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Get all members of a group\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$GroupName\n)\n\nGet-ADGroupMember -Identity $GroupName | \n    Select-Object Name, SamAccountName, objectClass |\n    Format-Table\n```\n\n## Create Group with Owners\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Create AD security group\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$GroupName,\n    \n    [Parameter(Mandatory=$true)]\n    [string]$Description,\n    \n    [Parameter(Mandatory=$false)]\n    [string]$OU = \"CN=Users\"\n)\n\n$Params = @{\n    Name = $GroupName\n    SamAccountName = $GroupName\n    GroupCategory = \"Security\"\n    GroupScope = \"Global\"\n    Description = $Description\n    Path = \"OU=Groups,$((Get-ADDomain).DistinguishedName)\"\n    DisplayName = $GroupName\n}\n\nNew-ADGroup @Params\nWrite-Host \"Created group: $GroupName\"\n```\n\n## Bulk Add Members from CSV\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Add multiple users to group from CSV\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$GroupName,\n    \n    [Parameter(Mandatory=$true)]\n    [string]$CSVPath\n)\n\n$Members = Import-Csv $CSVPath\n\nforeach ($Member in $Members) {\n    try {\n        Add-ADGroupMember -Identity $GroupName -Members $Member.Username -ErrorAction Stop\n        Write-Host \"Added: $($Member.Username)\" -ForegroundColor Green\n    }\n    catch {\n        Write-Host \"Failed: $($Member.Username) - $($_.Exception.Message)\" -ForegroundColor Red\n    }\n}\n```\n\n## Find Empty Groups\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Find groups with no members\n#>\n\nGet-ADGroup -Filter * | Where-Object {\n    (Get-ADGroupMember -Identity $_.SamAccountName -ErrorAction SilentlyContinue).Count -eq 0\n} | Select-Object Name, SamAccountName\n```\n\n## Group Membership Report\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Generate group membership report\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$OutputPath\n)\n\n$Groups = Get-ADGroup -Filter *\n\n$Report = foreach ($Group in $Groups) {\n    $Members = Get-ADGroupMember -Identity $Group.SamAccountName -ErrorAction SilentlyContinue\n    \n    [PSCustomObject]@{\n        GroupName = $Group.Name\n        MemberCount = $Members.Count\n        Members = ($Members.Name -join \", \")\n    }\n}\n\n$Report | Export-Csv -Path $OutputPath -NoTypeInformation\nWrite-Host \"Report saved to: $OutputPath\"\n```\n\n## Wrap-Up\n\nThese scripts cover the most common AD group operations. Save them to your toolkit.\n\nQuestions? Drop them below!","src/content/articles/active-directory-group-management.mdx","a44c79e135636ba7","active-directory-group-management.mdx",true,"certificate-management-windows",{"id":32,"data":34,"body":45,"filePath":46,"digest":47,"legacyId":48,"deferredRender":31},{"title":35,"description":36,"publishedAt":16,"pillar":37,"difficulty":38,"type":39,"tags":40,"draft":26},"Certificate Management in Windows","Managing certificates in Windows. SSL, code signing, and enterprise PKI. PowerShell certificate operations.","security","mid","how-to",[41,42,43,44,37],"certificates","pki","ssl","windows","# Certificate Management in Windows\n\nCertificates are everywhere in enterprise IT. Here's how to manage them in Windows.\n\n## Certificate Stores\n\n```powershell\n# View certificate stores\nGet-ChildItem Cert:\n\n# Local Machine stores\nCert:\\LocalMachine\\My        # Personal\nCert:\\LocalMachine\\Root       # Trusted Root\nCert:\\LocalMachine\\CA         # Intermediate CA\nCert:\\LocalMachine\\TrustedPeople\n\n# Current User stores\nCert:\\CurrentUser\\My\nCert:\\CurrentUser\\Root\n```\n\n## View Certificates\n\n```powershell\n# List certificates in store\nGet-ChildItem -Path Cert:\\LocalMachine\\My\n\n# Find expiring certificates\nGet-ChildItem -Path Cert:\\LocalMachine\\My | \n    Where-Object { $_.NotAfter -lt (Get-Date).AddDays(30) } |\n    Select-Object Subject, NotAfter, Thumbprint\n```\n\n## Install Certificate\n\n```powershell\n# From file\n$Cert = Import-Certificate -FilePath \"C:\\certs\\mycert.cer\" -CertStoreLocation Cert:\\LocalMachine\\My\n\n# From PFX (with private key)\n$Cert = Import-PfxCertificate -FilePath \"C:\\certs\\mycert.pfx\" -CertStoreLocation Cert:\\LocalMachine\\My -Password (ConvertTo-SecureString \"password\" -AsPlainText -Force)\n```\n\n## Request Certificate from CA\n\n```powershell\n# Create request\n$CSR = New-CertificateRequest -Subject \"CN=webserver.domain.com\" -KeyAlgorithm RSA -KeyLength 2048\n\n# Submit to CA\nSubmit-CertificateRequest -CertificateRequest $CSR -CertificationAuthority \"corp-ca.domain.com\"\n\n# Install response\nInstall-Certificate -Cert (Get-IssuedCertificate)\n```\n\n## Export Certificates\n\n```powershell\n# Export without private key\nExport-Certificate -Cert Cert:\\LocalMachine\\My\\Thumbprint -FilePath \"C:\\certs\\export.cer\"\n\n# Export with private key (PFX)\n$Cert = Get-ChildItem -Path Cert:\\LocalMachine\\My | Select-Object -First 1\nExport-PfxCertificate -Cert $Cert -FilePath \"C:\\certs\\backup.pfx\" -Password (ConvertTo-SecureString \"password\" -AsPlainText -Force)\n```\n\n## Remove Expired Certificates\n\n```powershell\n# Find and remove expired\nGet-ChildItem -Path Cert:\\LocalMachine\\My | \n    Where-Object { $_.NotAfter -lt (Get-Date) } |\n    Remove-Item\n\n# Remove specific certificate\nGet-ChildItem -Path Cert:\\LocalMachine\\My -Thumbprint \"thumbprinthere\" | Remove-Item\n```\n\n## SSL Certificate Binding\n\n```powershell\n# Bind certificate to IIS\nNew-WebBinding -Name \"Default Web Site\" -Protocol https -Port 443 -SslCertificateThumbprint \"thumbprint\"\n\n# Or use netsh\nnetsh http add sslcert ipport=0.0.0.0:443 certhash=thumbprint appid=\"{guid}\"\n```\n\n## Check Certificate Chain\n\n```powershell\n# Verify chain\n$Cert = Get-ChildItem -Path Cert:\\LocalMachine\\My | Select-Object -First 1\n[System.Security.Cryptography.X509Certificates.X509Chain]::Create().Chain.Build($Cert)\n```\n\n## Wrap-Up\n\nCertificates are essential. Automate expiration checks and always have a renewal process.\n\nQuestions? Drop them below!","src/content/articles/certificate-management-windows.mdx","edcf182a8d9be647","certificate-management-windows.mdx","bitlocker-recovery-keys-guide",{"id":49,"data":51,"body":60,"filePath":61,"digest":62,"legacyId":63,"deferredRender":31},{"title":52,"description":53,"publishedAt":16,"pillar":37,"difficulty":38,"type":39,"tags":54,"draft":26},"BitLocker Recovery Keys: The Complete Guide","Managing BitLocker recovery keys in enterprise environments. Backup, recovery, and automation with Intune.",[55,56,57,58,59],"bitlocker","encryption","recovery","intune","tpm","# BitLocker Recovery Keys: The Complete Guide\n\nBitLocker is essential for endpoint security, but if you lose the recovery keys, you're in trouble. This guide covers everything about managing BitLocker recovery keys in enterprise environments.\n\n## The Problem\n\nYou encrypt a machine with BitLocker, the user forgets their PIN, the TPM resets, or the machine reboots after a BIOS update — and suddenly you need the recovery key.\n\n**If you don't have it backed up, you're locked out. Permanently.**\n\n## Where Recovery Keys Are Stored\n\n### 1. Active Directory (Best Option)\n\n```powershell\n# Enable BitLocker key backup to AD\n# Via Group Policy:\n# Computer Configuration → Administrative Templates → Windows Components → BitLocker Drive Encryption → Store BitLocker recovery information in Active Directory Domain Services\n\n# Enable for domain members\nSet-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\FVE\" -Name \"ADBackedUp\" -Value 1 -Type DWord\n```\n\n### 2. Intune\n\n```powershell\n# In Intune:\n# Devices → Configuration profiles → Create → Endpoint protection → BitLocker\n\n# Enable key escrow\n# Settings: Select \"Store recovery keys in Intune\"\n```\n\n### 3. Azure AD\n\nAutomatically backed up when:\n- Device is Azure AD joined\n- User has correct licenses\n\n## How to Recover Keys\n\n### From Intune\n\n1. Go to **Microsoft Endpoint Manager**\n2. **Devices** → **All devices**\n3. Select the device\n4. Click **BitLocker recovery keys**\n\n```powershell\n# Via Graph API\nGet-MgDeviceManagementManagedDeviceBitLockerRecoveryKey -ManagedDeviceId $DeviceID\n```\n\n### From Active Directory\n\n```powershell\n# Using ADUC (Active Directory Users and Computers)\n# View → Advanced Features\n# Find computer object → Properties → BitLocker Recovery tab\n```\n\n### From Backup (8-digit ID)\n\nIf user has the 8-digit numerical ID:\n\n```powershell\n# In Intune recovery blade\n# Enter the 8-digit ID to retrieve the key\n```\n\n## Automating Key Backup\n\n### Script: Export Keys to SharePoint\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Export BitLocker keys to CSV\n#>\n\n$OutputFile = \"$env:TEMP\\BitLockerKeys_$(Get-Date -Format 'yyyyMMdd').csv\"\n\n# Get all devices with BitLocker\n$Devices = Get-MgDeviceManagementManagedDevice -Filter \"bitLockerEnabled eq true\" -All\n\n$Results = @()\n\nforeach ($Device in $Devices) {\n    $Keys = Get-MgDeviceManagementManagedDeviceBitLockerRecoveryKey -ManagedDeviceId $Device.Id -ErrorAction SilentlyContinue\n    \n    foreach ($Key in $Keys) {\n        $Results += [PSCustomObject]@{\n            DeviceName = $Device.DeviceName\n            DeviceID = $Device.AzureADDeviceID\n            KeyID = $Key.Id\n            RecoveryKey = $Key.BitLockerRecoveryKey\n            CreatedDate = $Key.CreatedDateTime\n        }\n    }\n}\n\n$Results | Export-Csv -Path $OutputFile -NoTypeInformation\nWrite-Host \"Exported to: $OutputFile\"\n```\n\n## Preventing Lockouts\n\n### 1. Save Recovery Keys EARLY\n\n```powershell\n# Script to save key during encryption\n$tpm = Get-Tpm\nif ($tvm.TpmPresent -and $tpm.TpmReady) {\n    Enable-BitLocker -MountPoint \"C:\" -EncryptionMethod XtsAes256 -UsedSpaceOnly -TpmProtector\n    \n    # Save recovery key locally as backup\n    $Key = Get-BitLockerVolume -MountPoint \"C:\" | Select-Object -ExpandProperty KeyProtector | Where-Object { $_.KeyProtectorType -eq \"RecoveryPassword\" }\n    \n    # Export to secure location\n    $Key.RecoveryPassword | Out-File \"C:\\BitLocker\\$env:USERNAME-Recovery.txt\"\n}\n```\n\n### 2. Configure TPM Properly\n\n```powershell\n# Check TPM status\nGet-Tpm\n\n# Clear TPM if needed (WARNING: may cause BitLocker to require recovery)\nClear-Tpm -AllowClear\n```\n\n### 3. Set Up MBAM (Microsoft BitLocker Administration and Monitoring)\n\nFor larger enterprises, MBAM provides:\n- Self-service portal\n- Admin key recovery\n- Compliance reporting\n\n## Common Errors\n\n### \"The operation could not be completed because the BitLocker protection software could not be enabled\"\n\n- Disable Secure Boot temporarily\n- Check TPM is enabled in BIOS\n- Update chipset/BIOS firmware\n\n### \"This PC doesn't support BitLocker\"\n\n- Check TPM version (must be 1.2+)\n- Check if Pro/Enterprise edition\n- Check Group Policy blocking\n\n## Quick Checklist\n\n- [ ] Keys backed up to AD or Intune\n- [ ] Users know their 8-digit ID\n- [ ] Self-service recovery portal configured\n- [ ] Documented recovery process for helpdesk\n- [ ] Test recovery before you need it\n\n## Wrap-Up\n\nBitLocker recovery keys are not optional in enterprise. Back them up, test recovery, and have a process.\n\nQuestions? Drop them below!","src/content/articles/bitlocker-recovery-keys-guide.mdx","41eeeedaf6175492","bitlocker-recovery-keys-guide.mdx","cis-benchmark-hardening-windows",{"id":64,"data":66,"body":75,"filePath":76,"digest":77,"legacyId":78,"deferredRender":31},{"title":67,"description":68,"publishedAt":16,"pillar":37,"difficulty":69,"type":39,"tags":70,"draft":26},"CIS Benchmark Hardening for Windows","Apply CIS Microsoft Windows 10/11 Enterprise Benchmark. Secure your Windows devices with proven security settings.","senior",[71,72,37,73,74],"cis","hardening","benchmark","endpoint-security","# CIS Benchmark Hardening for Windows\n\nCIS Benchmarks are industry-recognized security baselines. Here's how to apply them to Windows 10/11.\n\n## What is CIS?\n\nCenter for Internet Security (CIS) Benchmarks are:\n- Vendor-agnostic\n- Community-developed\n- Prioritized controls\n- Free to use\n\n## Getting the Benchmarks\n\n1. Download from: https://www.cisecurity.org/cis-benchmarks/\n2. Look for \"CIS Microsoft Windows 10 Enterprise Benchmark\"\n3. Get the Excel or PDF version\n\n## Key Controls to Implement\n\n### Control 1: Account Policies\n\n```powershell\n# Password Policy (via GPO or local)\n# Computer Configuration → Windows Settings → Security Settings → Account Policies\n\n# Recommended:\n# - Minimum password length: 14\n# - Password complexity: Enabled\n# - Maximum password age: 60\n# - Lockout threshold: 5\n```\n\n### Control 2: Local Policies\n\n```powershell\n# Audit Policy\n# - Logon events: Success, Failure\n# - Object access: Failure\n# - Policy change: Success\n\n# User Rights Assignment:\n# - Deny log on through Remote Desktop Services: Guests\n# - Allow log on locally: Users, Administrators\n```\n\n### Control 3: Windows Firewall\n\n```powershell\n# Enable Windows Firewall\n# Domain/Private/Public: Enabled\n\n# Default inbound: Block\n# Default outbound: Allow\n```\n\n### Control 4: Windows Defender\n\n```powershell\n# Enable Defender settings:\n# - Real-time protection: Enabled\n# - Behavior monitoring: Enabled\n# - Script scanning: Enabled\n# - Cloud-delivered protection: Enabled\n```\n\n### Control 5: Network Security\n\n```powershell\n# Disable SMBv1\nSet-SmbServerConfiguration -RequireSecuritySignature 0 -EnableSMB1Protocol 0 -Force\n\n# Disable NetBIOS over TCP/IP\n# In network adapter settings\n```\n\n## Using CIS-CAT Pro\n\nCIS provides a free scanner:\n\n```powershell\n# Download CIS-CAT Pro\n# Run assessment:\n# .\\CIS-CAT-Pro-Assessor-CLI.bat -assess -profile \"CIS Windows 10 Enterprise Benchmark\"\n```\n\n## Intune Integration\n\n```powershell\n# Import cis-cbl (CIS Configuration Baseline)\n# Or use security baselines in Intune:\n# Endpoint security → Security baselines → CIS Microsoft Windows\n```\n\n## Quick Hardening Script\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Quick CIS-style hardening\n#>\n\n# Disable SMBv1\nSet-SmbServerConfiguration -RequireSecuritySignature 0 -EnableSMB1Protocol 0 -Force\n\n# Enable Windows Firewall\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled True\n\n# Disable auto-play\nSet-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" -Name \"NoDriveTypeAutoRun\" -Value 255\n\n# Disable remote registry\nSet-Service -Name \"RemoteRegistry\" -StartupType Disabled\n\n# Disable Windows Script Host (if not needed)\n# Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows Script Host\\Settings\" -Name \"Enabled\" -Value 0\n\nWrite-Host \"Basic hardening complete\"\n```\n\n## Wrap-Up\n\nCIS benchmarks give you a proven security baseline. Start with the basics and work through the controls methodically.\n\nQuestions? Drop them below!","src/content/articles/cis-benchmark-hardening-windows.mdx","815e245c7da5c2c7","cis-benchmark-hardening-windows.mdx","common-bsod-error-codes",{"id":79,"data":81,"body":91,"filePath":92,"digest":93,"legacyId":94,"deferredRender":31},{"title":82,"description":83,"publishedAt":16,"pillar":84,"difficulty":38,"type":85,"tags":86,"draft":26},"Common BSOD Error Codes and Fixes","The most common Windows Blue Screen of Death (BSOD) error codes, what they mean, and how to fix them.","troubleshooting","error-reference",[87,88,89,90,44],"bsod","blue-screen","crash","stop-error","# Common BSOD Error Codes and Fixes\n\nThe Blue Screen of Death (BSOD) — every IT pro has seen it. Here's how to diagnose and fix the most common errors.\n\n## CRITICAL_PROCESS_DIED\n\n### Meaning\nA critical system process crashed.\n\n### Fix\n```powershell\n# Check for recent crashes\nGet-WinEvent -FilterHashtable @{LogName=\"System\";ID=1001} -MaxEvents 10\n\n# Run system file checker\nsfc /scannow\n\n# Check disk\nchkdsk C: /f /r\n\n# Update drivers, especially chipset and storage\n```\n\n## DRIVER_IRQL_NOT_LESS_OR_EQUAL (D1)\n\n### Meaning\nA driver tried to access memory it shouldn't.\n\n### Fix\n```powershell\n# Boot to safe mode\n# Uninstall recent driver updates\n# Roll back to previous version\n\n# Check for problematic drivers\ndriverquery /v | findstr /i \"error\"\n\n# Update BIOS and chipset drivers\n```\n\n## PAGE_FAULT_IN_NONPAGED_AREA\n\n### Meaning\nSystem tried to access invalid memory.\n\n### Fix\n```powershell\n# Check RAM\nmdsched.exe\n\n# Update drivers\n# Check for malware\n# Update Windows\n```\n\n## KERNEL_DATA_INPAGE_ERROR (7A)\n\n### Meaning\nCouldn't read/write data to disk.\n\n### Fix\n```powershell\n# Check disk health\nGet-PhysicalDisk | Get-StorageReliabilityCounter\n\n# Run chkdsk\nchkdsk C: /f /r /x\n\n# Check cable connections\n# Test with different SATA port\n```\n\n## SYSTEM_THREAD_EXCEPTION_NOT_HANDLED\n\n### Meaning\nA driver didn't handle an exception properly.\n\n### Fix\n```powershell\n# Update graphics drivers\n# Disable overclocking\n# Check for Windows updates\n# Run verifier to find driver:\n verifier /standard /driver mydriver.sys\n```\n\n## VIDEO_TDR_FAILURE / VIDEO_TDR_TIMEOUT_DETECTED\n\n### Meaning\nGraphics driver timed out.\n\n### Fix\n```powershell\n# Roll back graphics driver\n# Update to latest driver\n# Disable overclocking\n# Check GPU temperature\n\n# Disable TDR in registry (temporary):\nSet-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\GraphicsDrivers\" -Name \"TdrLevel\" -Value 0 -Type DWord\n```\n\n## IRQL_NOT_LESS_OR_EQUAL\n\n### Meaning\nDriver accessed memory at wrong IRQL.\n\n### Fix\n- Update all drivers\n- Check for conflicting software\n- Run SFC and DISM\n- Test with clean boot\n\n## BAD_POOL_HEADER\n\n### Meaning\nMemory pool corruption, usually driver-related.\n\n### Fix\n```powershell\n# Update network drivers especially\n# Run Memory Diagnostics\nmdsched.exe\n\n# Check for malware\n```\n\n## ACPI_BIOS_ERROR\n\n### Meaning\nBIOS/ACPI issue.\n\n### Fix\n```powershell\n# Update BIOS\n# Reset BIOS to defaults\n# Disable C-States in BIOS\n```\n\n## MACHINE_CHECK_EXCEPTION\n\n### Meaning\nHardware failure — CPU, RAM, or power.\n\n### Fix\n```powershell\n# Check CPU temperature\n# Test RAM with MemTest86\n# Check power supply\n# Update BIOS\n```\n\n## Quick BSOD Checklist\n\n1. Write down the error code\n2. Check Windows Event Viewer → System log\n3. Run `sfc /scannow`\n4. Update drivers\n5. Check RAM and disk health\n6. Check temps\n\n## Tools to Have\n\n- **WhoCrashed** — Analyzes crash dumps\n- **BlueScreenView** — View crash info\n- **WinDbg** — Advanced dump analysis\n- **MemTest86** — RAM testing\n\n## Wrap-Up\n\nBSODs are scary but usually fixable. The error code tells you where to look. Start with drivers, then hardware.\n\nQuestions? Drop them below!","src/content/articles/common-bsod-error-codes.mdx","07b0438b26bdeb85","common-bsod-error-codes.mdx","deploy-apps-intune-win32",{"id":95,"data":97,"body":105,"filePath":106,"digest":107,"legacyId":108,"deferredRender":31},{"title":98,"description":99,"publishedAt":16,"pillar":100,"difficulty":38,"type":39,"tags":101,"draft":26},"Deploy Apps with Intune Win32","Complete guide to deploying Win32 applications in Microsoft Intune. From packaging to deployment, covered.","deployment",[58,102,103,104],"win32","app-deployment","microsoft-endpoint-manager","# Deploy Apps with Intune Win32\n\nWin32 apps are the workhorse of Intune deployments. Unlike MSI or Store apps, Win32 gives you full control over installation, detection, and requirements. Here's the complete guide.\n\n## Why Win32?\n\n- **Bigger apps** — Up to 8GB per app\n- **Custom installs** — Any installer type\n- **Requirements** — Check prerequisites before install\n- **Detection** — Multiple ways to verify install\n\n## The Two Tools You Need\n\n### 1. Microsoft Win32 Content Prep Tool\nDownload from: https://github.com/microsoft/Microsoft-Win32-Content-Prep-Tool\n\n### 2. IntuneWinAppUtil.exe\n```powershell\n# Convert installer to .intunewin\n.\\IntuneWinAppUtil.exe -c C:\\Apps\\7zip -s 7zip-x64.exe -o C:\\Apps\\Output\n```\n\n## Step-by-Step Deployment\n\n### Step 1: Prepare the App\n\n```powershell\n# Create output folder\nNew-Item -ItemType Directory -Path C:\\Apps\\Output -Force\n\n# Run the prep tool\n# This creates a .intunewin file with detection logic\n```\n\n### Step 2: Upload to Intune\n\n1. Go to **Apps** → **Windows** → **Add**\n2. Select **Windows app (win32)**\n3. Upload your `.intunewin` file\n\n### Step 3: Configure Install/Uninstall\n\n```powershell\n# Install command\n# Example for 7-Zip:\n\"7zip-x64.exe /S\"\n\n# Uninstall command\n# Check in registry:\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\7-Zip\n```\n\n### Step 4: Set Requirements\n\n| Requirement | Use When |\n|-------------|----------|\n| OS version | App requires specific Windows version |\n| Architecture | x86 vs x64 apps |\n| RAM | Minimum memory needed |\n| Disk space | Required free space |\n| File/Folder exists | Prerequisite app installed |\n| Registry value | Previous app version |\n\n### Step 5: Detection Rules\n\nChoose how Intune knows the app is installed:\n\n| Method | Best For |\n|--------|----------|\n| MSI product code | MSI installers |\n| File exists | EXE-based apps |\n| Registry key | Apps with registry entries |\n| Script | Complex detection |\n\n```powershell\n# Example: File detection\nPath: C:\\Program Files\\7-Zip\\7zFM.exe\nDetection method: File or folder exists\n```\n\n### Step 6: Assign to Users/Devices\n\n- **Required** — Auto-install\n- **Available** — User self-service\n- **Uninstall** — Remove from devices\n\n## Troubleshooting\n\n### App Not Installing\n\n```powershell\n# Check Intune logs\n$LogPath = \"$env:ProgramData\\Microsoft\\Intune\\Logs\\MDMMgmt.log\"\nGet-Content $LogPath -Tail 100\n\n# Check Win32 app logs\n$IntuneLog = \"$env:TEMP\\IntuneApps.log\"\n```\n\n### Detection Rule Not Working\n\n```powershell\n# Test detection manually\nTest-Path \"C:\\Program Files\\AppName\\app.exe\"\n\n# Check registry\nGet-ItemProperty \"HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\AppName\"\n```\n\n## Pro Tips\n\n1. **Always test in audit mode first**\n2. **Use requirements to prevent failures**\n3. **Create detection rules from uninstall strings**\n4. **Document install/uninstall commands**\n\n## Wrap-Up\n\nWin32 apps give you the most control in Intune. Master this and you can deploy anything.\n\nQuestions? Drop them below!","src/content/articles/deploy-apps-intune-win32.mdx","d69ab6da40c779b6","deploy-apps-intune-win32.mdx","deploy-printers-intune",{"id":109,"data":111,"body":117,"filePath":118,"digest":119,"legacyId":120,"deferredRender":31},{"title":112,"description":113,"publishedAt":16,"pillar":100,"difficulty":18,"type":39,"tags":114,"draft":26},"Deploy Printers with Intune","Deploy network printers to Windows devices via Intune. Printer provisioning scripts and group policy alternatives.",[58,115,100,116,17],"printers","gpo","# Deploy Printers with Intune\n\nPrinter deployment has moved from GPO to modern management. Here's how to deploy network printers with Intune.\n\n## The Old Way: GPO\n\n```powershell\n# Traditional GPO printer connection\n# Still works but not \"modern management\"\nAdd-Printer -ConnectionName \"\\\\PrintServer\\PrinterName\"\n```\n\n## Modern Way: Intune Scripts\n\n### PowerShell Script: Install Printer\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Deploy network printer\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$PrinterPath,\n    \n    [Parameter(Mandatory=$false)]\n    [string]$DriverName\n)\n\n$ErrorActionPreference = \"Stop\"\n\ntry {\n    # Check if printer already exists\n    $Existing = Get-Printer -Name $PrinterPath -ErrorAction SilentlyContinue\n    \n    if ($Existing) {\n        Write-Host \"Printer already installed: $PrinterPath\"\n        exit 0\n    }\n    \n    # Add printer\n    if ($DriverName) {\n        Add-Printer -ConnectionName $PrinterPath -DriverName $DriverName\n    } else {\n        Add-Printer -ConnectionName $PrinterPath\n    }\n    \n    Write-Host \"Printer installed: $PrinterPath\"\n    exit 0\n}\ncatch {\n    Write-Host \"Error: $($_.Exception.Message)\"\n    exit 1\n}\n```\n\n### Make Printer Default\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Set default printer\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$PrinterName\n)\n\n# Set as default\n$Printer = Get-Printer -Name $PrinterName\nSet-PrintConfiguration -PrinterName $PrinterName -Datatype \"RAW\"\n\n# Make default via Windows settings\nSet-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\" -Name \"Device\" -Value \"$PrinterName,winspool,ne00:\"\n```\n\n## Deploy via Intune\n\n### Step 1: Create Script\n\n1. Go to **Devices** → **Scripts**\n2. **Add** → **Windows 10 and later**\n3. Upload script\n\n### Step 2: Assign to Groups\n\n- Target user or device groups\n- Run as logged-on user\n\n## Printer Driver Management\n\n```powershell\n# List installed drivers\nGet-PrinterDriver | Select-Object Name, DriverVersion\n\n# Install driver from inf\npnputil /add-driver printer.inf /install\n```\n\n## Troubleshooting\n\n```powershell\n# Check printer service\nGet-Service Spooler\n\n# Restart print spooler\nRestart-Service Spooler\n\n# Clear print queue\nGet-Process | Where-Object { $_.Name -eq \"spoolsv\" } | Stop-Process -Force\n\n# Clear temp files\nRemove-Item \"$env:SystemRoot\\System32\\Spool\\Printers\\*\" -Recurse -Force\n```\n\n## Universal Print (Cloud)\n\nFor Microsoft 365:\n\n```powershell\n# Connect to Universal Print\n# In Microsoft Endpoint Manager:\n# 1. Enable Universal Print connector\n# 2. Deploy via Intune\n# 3. Users get printer in Windows settings\n```\n\n## Wrap-Up\n\nPrinters are simple with modern management. Use PowerShell scripts in Intune, or move to Universal Print for cloud.\n\nQuestions? Drop them below!","src/content/articles/deploy-printers-intune.mdx","98ab558d7ed47b94","deploy-printers-intune.mdx","fix-user-profile-corruption",{"id":121,"data":123,"body":131,"filePath":132,"digest":133,"legacyId":134,"deferredRender":31},{"title":124,"description":125,"publishedAt":16,"pillar":84,"difficulty":18,"type":39,"tags":126,"draft":26},"Fix User Profile Corruption in Windows","Diagnose and fix corrupted Windows user profiles. Get users back to a working state quickly.",[44,127,128,129,130],"profile","corruption","fix","user-profile","# Fix User Profile Corruption in Windows\n\nUser profile corruption causes login issues, missing settings, and temp profile loads. Here's how to diagnose and fix it.\n\n## Symptoms\n\n- User gets \"The user profile service failed the logon\"\n- Profile loads as \"Temp\" profile\n- Desktop icons, settings, documents missing\n- \"User profile cannot be loaded\"\n\n## Quick Fix: Delete Corrupted Profile\n\n```powershell\n# Run as Admin\n# 1. Check current profiles\nGet-CimInstance Win32_UserProfile | Select-Object LocalPath, LastUseTime, Status\n\n# 2. Find the corrupted profile SID\n# Look in:\nC:\\Users\\\n\n# 3. Delete the folder\n# Navigate to:\nHKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList\n\n# 4. Delete the SID key for corrupted profile\n\n# 5. Delete the folder in C:\\Users\\\n```\n\n## Fix #2: System File Checker\n\n```powershell\n# Run in Admin PowerShell\nsfc /scannow\n\n# If that fails\nDISM /Online /Cleanup-Image /ScanHealth\nDISM /Online /Cleanup-Image /RestoreHealth\n```\n\n## Fix #3: Rebuild Default Profile\n\n```powershell\n# 1. Boot to WinPE or another admin account\n# 2. Delete the user folder\nRemove-Item -Path \"C:\\Users\\Username\" -Recurse -Force\n\n# 3. Create new profile from default\n# Copy default profile:\n$Default = \"$env:SystemDrive\\Users\\Default\"\n$NewProfile = \"C:\\Users\\NewUsername\"\nCopy-Item -Path $Default -Destination $NewProfile -Recurse\n\n# 4. Fix permissions\nicacls $NewProfile /reset /T\nicacls $NewProfile /grant \"DOMAIN\\NewUsername:(OI)(CI)F\"\n```\n\n## Fix #4: Registry Permissions\n\n```powershell\n# Profile list registry key permissions\n# 1. Go to:\nHKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList\n\n# 2. Right-click → Permissions\n# 3. Take ownership\n# 4. Grant SYSTEM Full Control\n# 5. Grant Administrators Full Control\n```\n\n## Fix #5: Disk Check\n\n```powershell\n# Check for disk errors\nchkdsk C: /f /r\n\n# Schedule for next reboot\n# Say Y to schedule\n```\n\n## Prevention\n\n1. **Don't delete profiles while user logged in**\n2. **Use proper shutdown, not强制关机**\n3. **Keep disk healthy**\n4. **Monitor disk space**\n\n## Wrap-Up\n\nCorrupted profiles are common but fixable. Delete, rebuild, or fix permissions — choose based on severity.\n\nQuestions? Drop them below!","src/content/articles/fix-user-profile-corruption.mdx","d85885bbde6d055c","fix-user-profile-corruption.mdx","getting-started-with-powershell",{"id":135,"data":137,"body":144,"filePath":145,"digest":146,"legacyId":147,"deferredRender":31},{"title":138,"description":139,"publishedAt":16,"pillar":17,"difficulty":18,"type":39,"tags":140,"draft":26},"Getting Started with PowerShell","A comprehensive guide for IT professionals to get started with PowerShell scripting and automation.",[21,141,142,143],"basics","automation","beginner","# Getting Started with PowerShell\n\nPowerShell is an essential tool for any IT professional. Whether you're managing Windows endpoints, automating Active Directory tasks, or querying Microsoft Graph, PowerShell is the backbone of modern Windows administration.\n\n## Why PowerShell?\n\nAs an IT desktop engineer, you'll encounter PowerShell in various scenarios:\n\n- **Intune/Endpoint Manager** — Device management via Microsoft Graph\n- **Active Directory** — User and group management\n- **Office 365** — Exchange, SharePoint, and Teams administration\n- **Automation** — Scheduled tasks and CI/CD pipelines\n\n## Prerequisites\n\nBefore diving in, ensure you have:\n\n1. Windows 10/11 or Windows Server 2019+\n2. PowerShell 5.1 or higher (7.x recommended)\n3. VS Code with PowerShell extension\n\n## Your First Script\n\nLet's create a simple script to gather system information:\n\n```powershell\n# Get-SystemInfo.ps1\n# System Information Gatherer\n\n$ComputerInfo = @{\n    ComputerName = $env:COMPUTERNAME\n    OS = (Get-CimInstance -ClassName Win32_OperatingSystem).Caption\n    Version = (Get-CimInstance -ClassName Win32_OperatingSystem).Version\n    LastBoot = (Get-CimInstance -ClassName Win32_OperatingSystem).LastBootUpTime\n    Uptime = ((Get-Date) - (Get-CimInstance -ClassName Win32_OperatingSystem).LastBootUpTime).ToString()\n}\n\n$ComputerInfo | ConvertTo-Json\n```\n\n### Running the Script\n\nSave the code above as `Get-SystemInfo.ps1` and run:\n\n```powershell\n.\\Get-SystemInfo.ps1\n```\n\n## Understanding the Pipeline\n\nOne of PowerShell's most powerful features is the pipeline:\n\n```powershell\n# Get all processes using more than 100MB of memory\nGet-Process | \n    Where-Object { $_.WorkingSet64 -gt 100MB } | \n    Sort-Object WorkingSet64 -Descending | \n    Select-Object -First 10 Name, @{N='MemoryMB';E={[math]::Round($_.WorkingSet64/1MB,2)}}\n```\n\n## Working with Objects\n\nEverything in PowerShell is an object. This makes it incredibly powerful:\n\n```powershell\n# Get the current date as an object\nGet-Date\n\n# Access properties\n(Get-Date).DayOfWeek\n\n# Call methods\n(Get-Date).AddDays(7)\n```\n\n## Best Practices\n\n1. **Always use -WhatIf** for destructive operations\n2. **Use strict mode** with `Set-StrictMode -Version Latest`\n3. **Comment your code** — Future you will thank present you\n4. **Use verbs from the approved list** — Get, Set, New, Remove, etc.\n\n## Next Steps\n\nIn future articles, we'll cover:\n\n- Working with APIs (REST endpoints)\n- Graph API authentication\n- Building modular scripts\n- Error handling\n- Creating scheduled tasks\n\nStay tuned!\n\n```powershell\n# Quick test - run this to verify PowerShell is working\nWrite-Host \"PowerShell is working!\" -ForegroundColor Green\n```","src/content/articles/getting-started-with-powershell.mdx","1d0806e79f403e6b","getting-started-with-powershell.mdx","intune-access-denied-fix",{"id":148,"data":150,"body":156,"filePath":157,"digest":158,"legacyId":159,"deferredRender":31},{"title":151,"description":152,"publishedAt":16,"pillar":100,"difficulty":38,"type":39,"tags":153,"draft":26},"Fix Intune Access Denied Errors","Resolving Access Denied errors when managing Intune devices. Step-by-step troubleshooting for the most common permission issues.",[58,104,154,155,84],"access-denied","permissions","# Fix Intune Access Denied Errors\n\nYou're trying to deploy an app, create a policy, or sync a device in Microsoft Intune, and suddenly you hit **\"Access Denied.\"** It's one of the most frustrating errors because it usually means something is broken in your permission chain — and the error message rarely tells you *what*.\n\nIn this guide, I'll walk you through the most common causes of Access Denied in Intune and how to fix them.\n\n## The Problem\n\nYou log into the Microsoft Endpoint Manager admin center, try to create a configuration profile, assign a policy, or even just view device details, and you get:\n\n> **Access Denied. You don't have permission to access this resource.**\n\nSometimes it affects everything, sometimes just specific actions. Let's dig in.\n\n## Cause #1: Missing Role Assignments\n\nThe most common cause. Intune uses Role-Based Access Control (RBAC), and if your account isn't assigned the right role, you're locked out.\n\n### How to Check\n\n1. Go to **Microsoft Endpoint Manager** → **Admin centers** → **Microsoft Endpoint Manager admin center**\n2. Navigate to **Tenant administration** → **Roles** → **All roles**\n3. Find your role or check what roles you have assigned\n\n### The Fix\n\n1. Go to **Tenant administration** → **Users** → Select your user\n2. Check **Intune role** assignments\n3. Add a built-in role like **Intune Administrator** or **Policy and Profile Manager**\n\n> **Screenshot placeholder:** *Show Intune role assignment blade*\n\n## Cause #2: Scope Tags Misconfiguration\n\nScope tags restrict what resources you can manage. Even with the right role, if you don't have the right scope tag, Access Denied.\n\n### How to Check\n\n1. Go to **Tenant administration** → **Roles** → **All roles**\n2. Open your assigned role\n3. Look at the **Scope (Tags)** section\n\n### The Fix\n\n- Either assign the scope tag that contains your target devices/profiles\n- Or create a custom role without scope tag restrictions\n\n```powershell\n# Quick check: What scope tags do I have?\nGet-MgDeviceManagementRoleAssignment -Filter \"principalId eq '$((Get-MgUser -UserId $env:USERNAME).id)'\" | \n    Select-Object RoleDefinitionName, ScopeTags\n```\n\n> **Screenshot placeholder:** *Show scope tag configuration*\n\n## Cause #3: Incorrect License Assignment\n\nYou need an Intune license to manage devices. Without it, you can't access the admin center properly.\n\n### The Fix\n\n1. Go to **Microsoft 365 admin center** → **Users** → **Active users**\n2. Select your account\n3. Verify **Intune (Plan 1)** or **Microsoft Intune Plan 2** is assigned\n\n```powershell\n# Check license via Graph\nGet-MgUserLicenseDetail -UserId $env:USERNAME | \n    Where-Object { $_.ServicePlans | Where-Object { $_.ServicePlanName -like \"*Intune*\" }}\n```\n\n## Cause #4: Conditional Access Policies Blocking Access\n\nConditional Access policies can lock you out of the Endpoint Manager portal if they exclude the admin accounts incorrectly.\n\n### The Fix\n\n1. Go to **Microsoft Entra ID** → **Security** → **Conditional Access**\n2. Look for policies targeting \"Microsoft Intune\" or \"Endpoint Manager\"\n3. Check the **Exclude** list — make sure your admin account isn't excluded inappropriately\n\n> **Warning:** Be careful not to lock yourself out completely!\n\n## Cause #5: Graph API Permissions (For Automation)\n\nIf you're using PowerShell scripts or automation (like the examples in this blog), you need the right API permissions.\n\n### The Fix\n\nIf using Azure AD App registrations:\n- **DeviceManagementManagedDevices.Read.All**\n- **DeviceManagementConfiguration.ReadWrite.All**\n- **DeviceManagementServiceConfiguration.ReadWrite.All**\n\n```powershell\n# Test Graph access\nConnect-MgGraph -Scopes \"DeviceManagementManagedDevices.Read.All\"\nGet-MgDeviceManagementManagedDevice -Top 1\n```\n\n## Cause #6: Device-Specific Block Issues\n\nSometimes Access Denied appears when trying to:\n- Wipe a device\n- Retire a device  \n- Push apps to a specific device\n\n### The Fix\n\n1. Check if the device is **blocked** in Intune\n2. Verify the device record exists and isn't orphaned\n3. Check if the user has been removed from Azure AD (orphaned device)\n\n```powershell\n# Find the device and check its status\nGet-MgDeviceManagementManagedDevice -Filter \"deviceName eq 'TARGETDEVICE'\" |\n    Select-Object DeviceName, UserId, EnrollmentState, DeviceRegistrationPolicy\n```\n\n## Quick Troubleshooting Checklist\n\n1. ✅ Do you have an Intune license?\n2. ✅ Are you assigned an Intune role?\n3. ✅ Does that role have the right permissions?\n4. ✅ Does the role include the right scope tags?\n5. ✅ Any Conditional Access policies blocking portal access?\n6. ✅ Is this a Graph API permission issue?\n\n## Wrap-Up\n\nAccess Denied in Intune is almost always a permission problem. Start with role assignments, check scope tags, verify licenses, and work your way through the list above.\n\nNeed help? Drop a comment below with what you're seeing.","src/content/articles/intune-access-denied-fix.mdx","43b8c65273473d96","intune-access-denied-fix.mdx","intune-device-restriction-profiles",{"id":160,"data":162,"body":168,"filePath":169,"digest":170,"legacyId":171,"deferredRender":31},{"title":163,"description":164,"publishedAt":16,"pillar":37,"difficulty":18,"type":39,"tags":165,"draft":26},"Intune Device Restriction Profiles Explained","Complete guide to Intune device restriction profiles. Configure Windows security settings, firewall, and more.",[58,166,74,167],"device-restrictions","configuration","# Intune Device Restriction Profiles Explained\n\nDevice restriction profiles in Intune are one of the most powerful tools for securing your endpoints. This guide walks through each setting and when to use it.\n\n## What Are Device Restriction Profiles?\n\nThey're Intune configuration profiles that control:\n- Device hardware\n- Windows features\n- Security settings\n- App installation\n- Network access\n\n## Creating a Profile\n\n1. Go to **Microsoft Endpoint Manager**\n2. **Devices** → **Configuration profiles**\n3. **Create profile** → **Windows 10 and later**\n4. Select **Device restrictions**\n\n## Settings Explained\n\n### 1. General\n\n| Setting | Options | Recommendation |\n|---------|---------|----------------|\n| Camera | Allow/Block | Allow (or block if sensitive) |\n| Removable storage | Allow/Block | Allow (audit) |\n| Wi-Fi | Allow/Block | Allow |\n| Bluetooth | Allow/Block | Allow (or disable if no BT needed) |\n\n### 2. Password\n\n| Setting | Value | Notes |\n|---------|-------|-------|\n| Password required | Enable | Required |\n| Minimum password length | 14+ | NIST recommendation |\n| Password type | Alphanumeric | Stronger |\n| Password age (days) | 60 | Rotate regularly |\n| Remember password history | 24 | Don't reuse |\n\n```powershell\n# Example: Force password complexity via Graph\n$Profile = @{\n    \"@odata.type\" = \"#microsoft.graph.windows10DeviceGeneralConfiguration\"\n    passwordRequired = $true\n    passwordMinimumLength = 14\n    passwordRequiredType = \"alphanumeric\"\n    passwordPreviousPasswordBlockCount = 24\n}\n```\n\n### 3. Account Protection\n\n- **Windows Hello for Business**: Enable\n- ** TPM**: Require TPM 2.0\n- **Anti-theft mode**: Enable\n\n### 4. Store\n\n- **Auto-update apps**: Enable\n- **Store**: Allow (or disable for locked-down)\n\n### 5. Windows Defender SmartScreen\n\n- **SmartScreen for Edge**: Require\n- **Warn about potentially dangerous apps**: Enable\n\n### 6. Network and Communications\n\n| Setting | Recommendation |\n|---------|----------------|\n| IPv6 forwarding | Disable |\n| Network bridge | Disable (unless needed) |\n| Wi-Fihotspot 2.0 | Enable |\n\n## Endpoint Security vs Device Configuration\n\n### Device Configuration\n- Day-to-day settings\n- User-facing controls\n- More granular\n\n### Endpoint Security\n- Security baselines\n- Hardening templates\n- Attack surface reduction\n\n## Example: High-Security Profile\n\n```json\n{\n  \"passwordRequired\": true,\n  \"passwordMinimumLength\": 16,\n  \"passwordComplexity\": \"strong\",\n  \"cameraBlocked\": true,\n  \"storageBlockRemovableStorage\": true,\n  \"defenderSmartScreenEnabled\": true,\n  \"firewallEnabled\": true,\n  \"windowsHelloRequired\": true,\n  \"tpmRequired\": true\n}\n```\n\n## Deployment\n\n1. Create profile\n2. Assign to groups\n3. Monitor compliance\n\n```powershell\n# Check compliance status\nGet-MgDeviceManagementDeviceConfiguration -Filter \"displayName eq 'High Security'\"\n```\n\n## Wrap-Up\n\nDevice restriction profiles are your primary tool for securing Windows endpoints. Start with basics and harden over time.\n\nQuestions? Drop them below!","src/content/articles/intune-device-restriction-profiles.mdx","db5674adbeddb7c3","intune-device-restriction-profiles.mdx","intune-compliance-policies",{"id":172,"data":174,"body":180,"filePath":181,"digest":182,"legacyId":183,"deferredRender":31},{"title":175,"description":176,"publishedAt":16,"pillar":37,"difficulty":38,"type":39,"tags":177,"draft":26},"Intune Compliance Policies Explained","Configure Intune device compliance policies. Set up conditions for access, conditional access, and device health.",[58,178,179,37],"compliance","conditional-access","# Intune Compliance Policies Explained\n\nCompliance policies in Intune define what makes a device \"healthy\" and secure. Combined with Conditional Access, they control device access to resources.\n\n## What Are Compliance Policies?\n\nRules that devices must meet to:\n- Access corporate resources\n- Use conditional access\n- Be considered \"managed\"\n\n## Creating a Policy\n\n1. **Microsoft Endpoint Manager** → **Devices** → **Compliance policies**\n2. **Create policy** → **Windows 10 and later**\n3. Set conditions and actions\n\n## Key Settings\n\n### Device Health\n\n| Setting | Options | Recommended |\n|---------|---------|-------------|\n| BitLocker | Require | Yes |\n| Secure Boot | Require | Yes |\n| Code Integrity | Require | Yes |\n| Device Health Attestation | Require | Yes |\n\n### Device Properties\n\n```powershell\n# Via Graph\n$Policy = @{\n    \"@odata.type\" = \"#microsoft.graph.windows10CompliancePolicy\"\n    deviceThreatProtectionRequiredSecurityLevel = \" Secured\"\n    bitLockerEnabled = $true\n    secureBootEnabled = $true\n    codeIntegrityEnabled = $true\n}\n```\n\n### System Security\n\n| Setting | Value |\n|---------|-------|\n| Password type | Alphanumeric |\n| Minimum password length | 14 |\n| Password age (days) | 60 |\n| Device password | Required |\n\n### Microsoft Defender\n\n```powershell\n# Require Defender\ndefenderEnabled = $true\ndefenderVersion = \"latest\"\n```\n\n## Compliance Actions\n\nWhen device is non-compliant:\n\n| Action | What Happens |\n|--------|--------------|\n| Mark as non-compliant | Visual indicator |\n| Send email to user | Notification |\n| Wipe device | Full reset |\n| Retire device | Remove from Intune |\n\n## Conditional Access Integration\n\nCompliance + Conditional Access = Access Control\n\n```powershell\n# Example: Require compliant device for Exchange\n# 1. Create compliance policy (above)\n# 2. Create conditional access policy in Azure AD:\n#   - Grant: Require device to be marked as compliant\n#   - Apps: Exchange Online\n#   - Users: All users\n```\n\n## Monitoring Compliance\n\n```powershell\n# Check compliance status\nGet-MgDeviceManagementDeviceCompliancePolicyState -DeviceId $DeviceId\n\n# Get all compliant/non-compliant\nGet-MgDeviceManagementDeviceCompliancePolicyState -All | \n    Where-Object { $_.ComplianceState -eq \"noncompliant\" }\n```\n\n## Wrap-Up\n\nCompliance policies are your first line of defense. Define healthy, require it with Conditional Access, and monitor compliance.\n\nQuestions? Drop them below!","src/content/articles/intune-compliance-policies.mdx","f5d4a3cd712c29cd","intune-compliance-policies.mdx","intune-enrollment-errors-fix",{"id":184,"data":186,"body":194,"filePath":195,"digest":196,"legacyId":197,"deferredRender":31},{"title":187,"description":188,"publishedAt":16,"pillar":100,"difficulty":38,"type":39,"tags":189,"draft":26},"Fix Intune Enrollment Errors","Troubleshoot common Intune enrollment errors. Get your Windows devices enrolled and managed quickly.",[58,190,191,192,193],"enrollment","mdm","autopilot","errors","# Fix Intune Enrollment Errors\n\nWindows device enrollment in Intune should be seamless. When it fails, the error messages aren't always helpful. Here's how to fix the most common enrollment errors.\n\n## Error: \"0x80180014 - MDM Enrolled Failed\"\n\nThis usually means the device already has an enrollment.\n\n### Fix\n\n```powershell\n# Run on client\nGet-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\MDM*\" | Select-Object *\n\n# Delete existing enrollment\nRemove-Item -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\MDM*\" -Recurse -Force\n\n# Re-enroll\n\"C:\\Program Files\\Microsoft OnlineManagement\\ProvTool\\ProvTool.exe\" /Oobe /Q\n```\n\n## Error: \"Device enrollment could not be completed\"\n\nGeneric error — check these things:\n\n### Fix\n\n1. **Check Intune license**\n```powershell\nGet-MgUserLicenseDetail -UserId $env:USERNAME | Select-Object -ExpandProperty ServicePlans\n```\n\n2. **Check auto-enroll settings**\n- Go to Microsoft Entra ID → Mobility (MDM and MAM)\n- Enable \"MDM user scope\" for All or Some users\n\n3. **Clear old enrollment**\n```powershell\nRemove-Item -Path \"HKLM:\\SOFTWARE\\Microsoft\\Enrollments\\*\" -Recurse -Force\n```\n\n## Error: \"0x801c0003 - The device is already enrolled\"\n\nThe device has a stale enrollment record.\n\n### Fix\n\n```powershell\n# In Intune, manually retire the device first\n# Then on client:\ndsregcmd /leave /debug\n\n# Re-enroll\ndsregcmd /join\n```\n\n## Error: \"Certificate enrollment server not available\"\n\nUsually a network or DNS issue.\n\n### Fix\n\n```powershell\n# Test connectivity\nTest-NetConnection -ComputerName enterpriseregistration.windows.net -Port 443\n\n# Check DNS\nResolve-DnsName enterpriseregistration.windows.net\n\n# Check proxy\nnetsh winhttp show proxy\n```\n\n## Error: \"Enrollment timed out\"\n\n### Fix\n\n```powershell\n# Increase timeout in registry\nSet-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\MDM\" -Name \"EnrollmentTimeout\" -Value 300 -Type DWord\n\n# Check for third-party software blocking\nGet-Process | Where-Object { $_.Company -notlike \"Microsoft*\" } | Select-Object Name, Company\n```\n\n## Error: Autopilot Profile Not Found\n\n### Fix\n\n1. **Assign profile to device group**\n   - Intune → Devices → Windows → Autopilot deployment profiles\n   - Assign to device group containing the hardware ID\n\n2. **Upload hardware ID if missing**\n   - Intune → Devices → Windows → Upload hardware IDs\n   - Get hardware ID: `Get-WindowsAutoPilotInfo -Computer .`\n\n## Error: 0x80180005 - Unknown Error\n\nUsually permission-related.\n\n### Fix\n\n```powershell\n# Check user has enrollment permission\n# In Intune: Device enrollment managers → Add your account\n\n# Or check MDM authority\nGet-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\MDM\" -Name \"MdmAuthority\"\n```\n\n## Quick Enrollment Checklist\n\n- [ ] User has Intune license\n- [ ] MDM auto-enroll is enabled in Azure AD\n- [ ] No conflicting MDM enrollment\n- [ ] Network can reach required endpoints\n- [ ] Date/time is correct on client\n- [ ] No third-party security software blocking\n\n## Required Endpoints\n\n```\nenterprisesEnrollment.windows.net\nenterpriseregistration.windows.net\nmanagement.azure.com\ngraph.windows.net\n```\n\n## Wrap-Up\n\nEnrollment errors are usually licensing, network, or stale records. Clear the old enrollment and try again.\n\nQuestions? Drop them below!","src/content/articles/intune-enrollment-errors-fix.mdx","65974ccd735a1b7f","intune-enrollment-errors-fix.mdx","location-services-grayed-out-fix",{"id":198,"data":200,"body":207,"filePath":208,"digest":209,"legacyId":210,"deferredRender":31},{"title":201,"description":202,"publishedAt":16,"pillar":84,"difficulty":18,"type":39,"tags":203,"draft":26},"Fix Grayed Out Location Services in Windows","How to enable grayed out Location Services in Windows 11/10. Fix Group Policy and registry settings that lock location.",[44,204,205,206,116],"location-services","group-policy","registry","# Fix Grayed Out Location Services in Windows\n\nYou need to enable Location Services for an app, but the toggle is grayed out. You click it, nothing happens. You check Settings, nothing. This is a common issue in corporate environments — and it usually means a Group Policy or registry key is blocking it.\n\n## The Problem\n\nThe **Location Services** toggle in Windows Settings is:\n- Grayed out / Disabled\n- Or gives an error when you try to turn it on\n- Or only allows turning off, not on\n\n## Quick Fix: Registry Edit\n\nThe fastest fix is often a registry tweak.\n\n### Step 1: Open Registry Editor\n\n1. Press **Win + R**\n2. Type `regedit` → press **Enter**\n3. Navigate to:\n\n```\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors\n```\n\n### Step 2: Check the Values\n\nLook for these DWORD values:\n- **DisableLocation** = 1 → Set to **0**\n- **DisableLocationScripting** = 1 → Set to **0**\n\n```powershell\n# Quick PowerShell fix\nSet-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors\" -Name \"DisableLocation\" -Value 0 -Type DWord\nSet-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors\" -Name \"DisableLocationScripting\" -Value 0 -Type DWord\n```\n\n> **Screenshot placeholder:** *Show registry values*\n\n### Step 3: Restart or Sign Out\n\nChanges may require a restart or sign-out to take effect.\n\n## Fix #2: Group Policy\n\nIf the registry key keeps reverting, a Group Policy is likely enforcing it.\n\n### Check Local Group Policy\n\n1. Press **Win + R** → type `gpedit.msc`\n2. Navigate to:\n\n```\nComputer Configuration → Administrative Templates → System → Location and Sensors\n```\n\n3. Look for **\"Turn off location\"** — if it's **Enabled**, that's your culprit.\n\n### The Fix\n\nSet it to **Not Configured** or **Disabled**, then restart.\n\n```powershell\n# Check via PowerShell\nGet-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors\" -Name \"DisableLocation\" -ErrorAction SilentlyContinue\n```\n\n## Fix #3: MDM/Intune Policy\n\nIf you're on a managed device, Intune might be pushing a device restriction.\n\n### Check Intune\n\n1. Go to **Microsoft Endpoint Manager**\n2. **Devices** → **Configuration profiles**\n3. Look for profiles with **\"Location Services\"** settings\n\n### The Fix\n\nEither:\n- Update the policy to allow location\n- Create an exclusion group for affected devices\n\n```powershell\n# Check MDM diagnostic logs\n$LogPath = \"$env:ProgramData\\Microsoft\\Intune\\Logs\\MDMMgmt.log\"\nGet-Content $LogPath -Tail 50 | Select-String -Pattern \"Location\"\n```\n\n## Fix #4: User Account Issues\n\nSometimes the issue is user-specific.\n\n### Step 1: Create a New Local Admin Test\n\n1. Create a new local admin account\n2. Log in as that user\n3. Check if Location Services is enabled\n\nIf it works, the issue is with your user profile.\n\n### Step 2: Reset Location Settings\n\n```powershell\n# Reset location for current user\nGet-ItemProperty -Path \"HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\LocationAndSensors\" | Remove-Item -Recurse -Force\n```\n\n## Fix #5: System Services\n\nCheck the Location service is running:\n\n1. Press **Win + R** → type `services.msc`\n2. Find **\"Windows Location Service\"**\n3. Ensure it's **Running** and set to **Automatic**\n\n```powershell\n# Check and start service\nGet-Service -Name \"Windows Location Service\" | Set-Service -StartupType Automatic\nStart-Service -Name \"Windows Location Service\"\n```\n\n## Fix #6: Registry Permissions\n\nIf you can't edit the registry, you may need to take ownership:\n\n1. Right-click the key → **Permissions**\n2. Take ownership as Administrator\n3. Grant Full Control to user\n\n## Quick Summary your\n\n| Fix | Method |\n|-----|--------|\n| 1 | Registry edit → DisableLocation = 0 |\n| 2 | Group Policy → gpedit.msc |\n| 3 | Check Intune MDM policies |\n| 4 | Test with new user account |\n| 5 | Verify Windows Location Service running |\n| 6 | Fix registry permissions |\n\n## Wrap-Up\n\nGrayed out Location Services is almost always a policy block. Check registry first, then Group Policy, then MDM. \n\nQuestions? Drop them below!","src/content/articles/location-services-grayed-out-fix.mdx","c5cc37b1b036c97e","location-services-grayed-out-fix.mdx","microsoft-graph-api-intune",{"id":211,"data":213,"body":219,"filePath":220,"digest":221,"legacyId":222,"deferredRender":31},{"title":214,"description":215,"publishedAt":16,"pillar":17,"difficulty":69,"type":39,"tags":216,"draft":26},"Microsoft Graph API for Intune","Automate Intune with Microsoft Graph API. PowerShell scripts for device management, policy deployment, and reporting.",[217,58,218,142,21],"microsoft-graph","api","# Microsoft Graph API for Intune\n\nThe Microsoft Graph API is the modern way to automate Intune. If you're still using legacy MSOnline or AzureADPreview modules, it's time to migrate. Here's how.\n\n## Authentication\n\n### App Registration Setup\n\n1. Go to **Azure Portal** → **App registrations**\n2. Create new registration\n3. Add API permissions:\n   - `DeviceManagementManagedDevices.Read.All`\n   - `DeviceManagementConfiguration.ReadWrite.All`\n   - `DeviceManagementServiceConfiguration.ReadWrite.All`\n4. Grant admin consent\n5. Create client secret\n\n### Connect via PowerShell\n\n```powershell\n# Install Graph module\nInstall-Module Microsoft.Graph -Scope CurrentUser\n\n# Connect with app\n$ClientId = \"your-app-id\"\n$TenantId = \"your-tenant-id\"\n$ClientSecret = \"your-secret\"\n\n$Body = @{\n    Grant_Type    = \"client_credentials\"\n    Scope        = \"https://graph.microsoft.com/.default\"\n    Client_Id     = $ClientId\n    Client_Secret = $ClientSecret\n}\n\n$TokenResponse = Invoke-RestMethod -Uri \"https://login.microsoftonline.com/$TenantId/oauth2/v2.0/token\" -Method POST -Body $Body\n\n# Connect to Graph\nConnect-MgGraph -AccessToken $TokenResponse.access_token\n```\n\n## Common Intune Operations\n\n### Get All Devices\n\n```powershell\n# Get all managed devices\nGet-MgDeviceManagementManagedDevice -All | \n    Select-Object DeviceName, DeviceType, OperatingSystem, LastSyncDateTime\n```\n\n### Get Specific Device\n\n```powershell\n# Find by name\nGet-MgDeviceManagementManagedDevice -Filter \"deviceName eq 'LAPTOP-001'\"\n```\n\n### Sync a Device\n\n```powershell\n# Trigger sync\n$DeviceId = (Get-MgDeviceManagementManagedDevice -Filter \"deviceName eq 'LAPTOP-001'\").Id\n\nInvoke-MgDeviceManagementManagedDeviceSyncDevice -ManagedDeviceId $DeviceId\n```\n\n### Get Device Compliance\n\n```powershell\n# Get compliance states\nGet-MgDeviceManagementDeviceCompliancePolicy -All |\n    Select-Object DisplayName, Id\n```\n\n### Assign Policy to Group\n\n```powershell\n# Get group ID\n$GroupId = (Get-MgGroup -Filter \"displayName eq 'IT Devices'\").Id\n\n# Get policy ID\n$PolicyId = (Get-MgDeviceManagementDeviceConfiguration -Filter \"displayName eq 'Security Policy'\").Id\n\n# Assign\n$Params = @{\n    \"@odata.id\" = \"https://graph.microsoft.com/v1.0/groups('$GroupId')\"\n}\n\nInvoke-MgDeviceManagementDeviceConfigurationAssign -DeviceConfigurationId $PolicyId -BodyParameter $Params\n```\n\n## Creating Objects\n\n### Create Configuration Profile\n\n```powershell\n$ProfileParams = @{\n    \"@odata.type\" = \"#microsoft.graph.windows10CustomConfiguration\"\n    DisplayName = \"Custom Settings Profile\"\n    Description = \"Created via Graph API\"\n    OmaSettings = @(\n        @{\n            \"@odata.type\" = \"#microsoft.graph.omaSettingString\"\n            DisplayName = \"Device Name\"\n            OmaUri = \"./Vendor/MSFT/Device/Virtualization/WSName\"\n            Value = \"CORP-{SERIAL}\"\n        }\n    )\n}\n\nNew-MgDeviceManagementDeviceConfiguration -BodyParameter $ProfileParams\n```\n\n### Create Device Group\n\n```powershell\n$GroupParams = @{\n    DisplayName = \"Windows 11 Devices\"\n    Description = \"Devices running Windows 11\"\n    MailEnabled = $false\n    MailNickname = \"Win11Devices\"\n    SecurityEnabled = $true\n}\n\nNew-MgGroup -BodyParameter $GroupParams\n```\n\n## Error Handling\n\n```powershell\ntry {\n    $Device = Get-MgDeviceManagementManagedDevice -DeviceId $DeviceId -ErrorAction Stop\n}\ncatch {\n    if ($_.Exception.Message -match \"404\") {\n        Write-Host \"Device not found\"\n    }\n    else {\n        throw $_\n    }\n}\n```\n\n## Pagination\n\n```powershell\n# Graph returns max 100 by default\n# Use -Top for more\nGet-MgDeviceManagementManagedDevice -Top 999 -All\n```\n\n## Wrap-Up\n\nGraph API is powerful but requires setup. Create an app registration, get permissions, and automate everything.\n\nQuestions? Drop them below!","src/content/articles/microsoft-graph-api-intune.mdx","321fff400b25dd43","microsoft-graph-api-intune.mdx","intune-device-wipe-retire",{"id":223,"data":225,"body":233,"filePath":234,"digest":235,"legacyId":236,"deferredRender":31},{"title":226,"description":227,"publishedAt":16,"pillar":100,"difficulty":18,"type":39,"tags":228,"draft":26},"Intune Device Wipe and Retire","How to wipe, retire, or factory reset devices in Microsoft Intune. Complete guide for device lifecycle management.",[58,229,230,231,232],"wipe","retire","factory-reset","device-management","# Intune Device Wipe and Retire\n\nWhen a device needs to be reset or removed, Intune gives you options. Here's when to use each.\n\n## Wipe vs Retire\n\n| Action | What Happens | Use When |\n|--------|--------------|----------|\n| **Retire** | Remove managed apps/data, keep device | User leaves, device reassigned |\n| **Wipe** | Factory reset, delete everything | Device being sold, serious issues |\n| **Autopilot Reset** | Clean but keep enrollment | Refresh device, keep Intune |\n\n## Retire a Device\n\n```powershell\n# Via Graph API\n$DeviceId = (Get-MgDeviceManagementManagedDevice -Filter \"deviceName eq 'LAPTOP-001'\").Id\n\nInvoke-MgDeviceManagementManagedDeviceRetireManagedDevice -ManagedDeviceId $DeviceId\n```\n\n### What Happens\n- Company data removed\n- Apps uninstalled\n- Settings reverted\n- Device remains in Intune (unmanaged)\n\n## Wipe a Device\n\n```powershell\n# Full wipe\n$DeviceId = (Get-MgDeviceManagementManagedDevice -Filter \"deviceName eq 'LAPTOP-001'\").Id\n\nInvoke-MgDeviceManagementManagedDeviceWipeManagedDevice -ManagedDeviceId $DeviceId -KeepUserData $false\n```\n\n### Options\n- **Keep user data**: Yes/No\n- **Persist enrolled apps**: Yes/No (Windows)\n\n## Autopilot Reset\n\n```powershell\n# Trigger Autopilot reset\n$DeviceId = (Get-MgDeviceManagementManagedDevice -Filter \"deviceName eq 'LAPTOP-001'\").Id\n\nInvoke-MgDeviceManagementManagedDevice windowsAutopilotDeviceIdentity -ManagedDeviceId $DeviceId -ResetAccount\n```\n\n### What It Does\n- Removes user accounts\n- Re-enrolls in Intune\n- Like fresh OOBE\n- Keeps Autopilot enrollment\n\n## Confirmation Required\n\n```powershell\n# Devices in user-driven enrollment require:\n# - User confirmation on device\n# OR\n# - Recovery key provided first\n\n# Check if device requires recovery key\nGet-MgDeviceManagementManagedDevice -DeviceId $DeviceId |\n    Select-Object recoveryKeyIdentifier\n```\n\n## Pre-Wipe Checklist\n\n- [ ] Backup user data (if keeping)\n- [ ] Export BitLocker keys\n- [ ] Document serial number\n- [ ] Check device ownership\n\n```powershell\n# Export BitLocker keys before wipe\nGet-MgDeviceManagementManagedDeviceBitLockerRecoveryKey -ManagedDeviceId $DeviceId\n```\n\n## Automation Script\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Safely wipe a device\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$DeviceName,\n    \n    [Parameter(Mandatory=$false)]\n    [switch]$KeepUserData\n)\n\n$Device = Get-MgDeviceManagementManagedDevice -Filter \"deviceName eq '$DeviceName'\"\n\nif (-not $Device) {\n    Write-Host \"Device not found: $DeviceName\"\n    exit 1\n}\n\n# Export recovery keys first\n$Keys = Get-MgDeviceManagementManagedDeviceBitLockerRecoveryKey -ManagedDeviceId $Device.Id\n\n# Backup keys\n$Keys | Export-Csv -Path \".\\$DeviceName-BitLockerKeys.csv\"\n\n# Confirm wipe\nWrite-Host \"About to WIPE device: $DeviceName\"\nWrite-Host \"This cannot be undone!\"\n$Confirm = Read-Host \"Type 'YES' to confirm\"\n\nif ($Confirm -eq \"YES\") {\n    Invoke-MgDeviceManagementManagedDeviceWipeManagedDevice -ManagedDeviceId $Device.Id -KeepUserData:$KeepUserData\n    Write-Host \"Wipe initiated\"\n}\n```\n\n## Wrap-Up\n\nUse Retire for reassignment, Wipe for disposal, Autopilot Reset for refresh. Always backup keys first.\n\nQuestions? Drop them below!","src/content/articles/intune-device-wipe-retire.mdx","435a3ba1c82a1a1f","intune-device-wipe-retire.mdx","network-sharing-troubleshooting",{"id":237,"data":239,"body":247,"filePath":248,"digest":249,"legacyId":250,"deferredRender":31},{"title":240,"description":241,"publishedAt":16,"pillar":84,"difficulty":18,"type":39,"tags":242,"draft":26},"Network Sharing Troubleshooting Guide","Fix Windows network sharing issues. File sharing, printer sharing, and network discovery problems solved.",[243,244,245,246,84],"network","sharing","samba","smb","# Network Sharing Troubleshooting Guide\n\nNetwork shares not working? Can't see other computers? Here's how to fix common Windows sharing issues.\n\n## Quick Checklist\n\n- [ ] Network set to Private\n- [ ] File and Printer Sharing enabled\n- [ ] Same workgroup (for legacy)\n- [ ] Same subnet\n- [ ] Firewall allows SMB\n\n## Enable File Sharing\n\n```powershell\n# Enable via PowerShell (Admin)\nEnable-NetFirewallRule -Name \"FileAndPrinterSharing-SMB-In\"\nEnable-NetFirewallRule -Name \"FileAndPrinterSharing-In\"\nEnable-NetFirewallRule -Name \"FileAndPrinterSharing-llmnr-In\"\n\n# Enable sharing\nSet-SmbServerConfiguration -EnableSMB1Protocol $false -Force\nSet-SmbServerConfiguration -RequireSecuritySignature $false -Force\n```\n\n## Create a Share\n\n```powershell\n# Create folder\nNew-Item -ItemType Directory -Path \"C:\\Shared\"\n\n# Share it\nNew-SmbShare -Name \"Shared\" -Path \"C:\\Shared\" -FullAccess \"Everyone\"\n\n# Or use NTFS permissions\n$ACL = Get-Acl \"C:\\Shared\"\n$AccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule(\"DOMAIN\\Users\",\"FullControl\",\"ContainerInherit,ObjectInherit\",\"None\",\"Allow\")\n$ACL.SetAccessRule($AccessRule)\nSet-Acl \"C:\\Shared\" $ACL\n```\n\n## Access a Share\n\n```powershell\n# Map drive\nNew-PSDrive -Name \"S\" -PSProvider FileSystem - \"\\\\ServerName\\ShareName\"\n\n# Test connection\nTest-Path \"\\\\ServerName\\ShareName\"\n\n# View shares on server\nGet-SmbShare -CimSession ServerName\n```\n\n## Fix \"Access Denied\"\n\n```powershell\n# Check share permissions\nGet-SmbShareAccess -Name \"ShareName\"\n\n# Reset permissions\nGrant-SmbShareAccess -Name \"ShareName\" -AccountName \"Everyone\" -AccessRight Full -Force\n```\n\n## SMB Version Issues\n\n```powershell\n# Check SMB versions enabled\nGet-SmbServerConfiguration\n\n# Enable SMBv2 (if needed)\nSet-SmbServerConfiguration -EnableSMB2Protocol $true\n\n# Disable SMBv1 (security!)\nSet-SmbServerConfiguration -EnableSMB1Protocol $false\n```\n\n## Network Discovery Not Working\n\n```powershell\n# Enable network discovery\nSet-NetFirewallProfile -Profile Private -Enabled True\nGet-BrowserManager | Enable 2>/dev/null # or\n\n# Enable these services:\nStart-Service -Name \"fdPHost\"\nStart-Service -Name \"Browser\"\nStart-Service -Name \"LanmanServer\"\nStart-Service -Name \"LanmanWorkstation\"\n```\n\n## Common Error Codes\n\n| Error | Meaning |\n|-------|---------|\n| 0x80070035 | Network path not found |\n| 0x80070043 | Network name cannot be found |\n| 0x800704cf | Network is offline |\n| 0x80004005 | Unspecified error |\n\n## Wrap-Up\n\nMost sharing issues are firewall or permission-related. Check those first, then SMB versions.\n\nQuestions? Drop them below!","src/content/articles/network-sharing-troubleshooting.mdx","06032537d6f31f6e","network-sharing-troubleshooting.mdx","powershell-error-handling",{"id":251,"data":253,"body":259,"filePath":260,"digest":261,"legacyId":262,"deferredRender":31},{"title":254,"description":255,"publishedAt":16,"pillar":17,"difficulty":18,"type":39,"tags":256,"draft":26},"PowerShell Error Handling Best Practices","Write robust PowerShell scripts with proper error handling. Try/Catch, -ErrorAction, and logging strategies.",[21,257,17,258],"error-handling","best-practices","# PowerShell Error Handling Best Practices\n\nBad error handling makes scripts fragile. Good error handling makes them professional. Here's how to write PowerShell that fails gracefully.\n\n## The Basics\n\n### -ErrorAction Parameter\n\n```powershell\n# Different levels\nStop      # Throw exception (use with Try/Catch)\nContinue  # Write to $error and continue (default)\nSilentlyContinue # Suppress error message\nInquire   # Ask user what to do\n\n# Examples\nGet-Item C:\\Missing -ErrorAction Stop\nGet-Item C:\\Missing -ErrorAction SilentlyContinue\n```\n\n### Try/Catch/Finally\n\n```powershell\ntry {\n    # Risky operation\n    Get-Content \"C:\\important.txt\" -ErrorAction Stop\n    \n    # Success path\n    Write-Host \"File found!\"\n}\ncatch {\n    # What to do on failure\n    Write-Host \"Error: $($_.Exception.Message)\"\n    \n    # Log the error\n    $Error | Out-File \"C:\\Logs\\errors.log\" -Append\n}\nfinally {\n    # Always runs - cleanup\n    Remove-Item $tempFile -ErrorAction SilentlyContinue\n}\n```\n\n## Types of Errors\n\n### Terminating vs Non-Terminating\n\n```powershell\n# Terminating - stops execution\n# Use -ErrorAction Stop to convert\n\n# Non-terminating - continues\nGet-ChildItem C:\\ -Recurse -ErrorAction SilentlyContinue\n\n# Make terminating\n$ErrorActionPreference = \"Stop\"\n```\n\n### Catch Specific Errors\n\n```powershell\ntry {\n    Get-ADUser \"doesntexist\"\n}\ncatch [Microsoft.ActiveDirectory.Management.ADIdentityNotFoundException] {\n    Write-Host \"User not found\"\n}\ncatch [System.UnauthorizedAccessException] {\n    Write-Host \"Access denied\"\n}\ncatch {\n    Write-Host \"Unexpected error: $_\"\n}\n```\n\n## Logging Errors\n\n```powershell\nfunction Write-ErrorLog {\n    param([string]$Message)\n    \n    $LogPath = \"$env:TEMP\\ScriptErrors.log\"\n    $Timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    \n    \"$Timestamp - $Message\" | Out-File $LogPath -Append\n}\n\n# Usage\ntry {\n    Invoke-RestMethod \"https://api.example.com/data\" -ErrorAction Stop\n}\ncatch {\n    Write-ErrorLog \"API call failed: $($_.Exception.Message)\"\n    throw\n}\n```\n\n## Validation Patterns\n\n```powershell\n# Pre-flight checks\nfunction Install-App {\n    param([string]$InstallerPath)\n    \n    # Validate input\n    if (-not (Test-Path $InstallerPath)) {\n        throw \"Installer not found: $InstallerPath\"\n    }\n    \n    # Validate disk space\n    $FreeSpace = (Get-PSDrive C).Free\n    if ($FreeSpace -lt 1GB) {\n        throw \"Insufficient disk space\"\n    }\n    \n    # Proceed with install\n}\n```\n\n## Retry Logic\n\n```powershell\nfunction Invoke-WithRetry {\n    param(\n        [scriptblock]$ScriptBlock,\n        [int]$MaxAttempts = 3,\n        [int]$DelaySeconds = 5\n    )\n    \n    for ($i = 1; $i -le $MaxAttempts; $i++) {\n        try {\n            & $ScriptBlock -ErrorAction Stop\n            return\n        }\n        catch {\n            if ($i -eq $MaxAttempts) {\n                throw \"Failed after $MaxAttempts attempts: $_\"\n            }\n            Write-Host \"Attempt $i failed, retrying...\"\n            Start-Sleep -Seconds $DelaySeconds\n        }\n    }\n}\n\n# Usage\nInvoke-WithRetry -ScriptBlock {\n    Test-NetConnection -ComputerName \"api.example.com\" -Port 443\n} -MaxAttempts 3 -DelaySeconds 5\n```\n\n## $PSItem vs $_\n\n```powershell\n# Both work the same\ncatch {\n    $_.Exception.Message      # The error message\n    $_.Exception.GetType()    # Exception type\n    $_.ScriptStackTrace      # Where it happened\n    $_.TargetObject           # What failed\n}\n```\n\n## Common Mistakes\n\n❌ **Bad:**\n```powershell\nGet-Item C:\\file.txt\nif ($?) { Write-Host \"Success\" }\n```\n\n✅ **Good:**\n```powershell\ntry {\n    Get-Item C:\\file.txt -ErrorAction Stop\n    Write-Host \"Success\"\n}\ncatch {\n    Write-Host \"Failed\"\n}\n```\n\n## Wrap-Up\n\nAlways assume things can fail. Use Try/Catch, log errors, and validate inputs. Your future self will thank you.\n\nQuestions? Drop them below!","src/content/articles/powershell-error-handling.mdx","598fb844f1a7492f","powershell-error-handling.mdx","intune-stuck-sync-fixer",{"id":263,"data":265,"body":272,"filePath":273,"digest":274,"legacyId":275,"deferredRender":31},{"title":266,"description":267,"publishedAt":16,"pillar":100,"difficulty":38,"type":39,"tags":268,"draft":26},"Fix Intune Stuck in Sync Loop","Troubleshooting devices stuck in sync loops in Microsoft Intune. Get your endpoints back to a managed state quickly.",[58,269,270,271,84],"sync","stuck","endpoint-manager","# Fix Intune Stuck in Sync Loop\n\nYou check your Intune console and see it — a device that's been \"Syncing\" for hours. Or maybe it syncs successfully, but the policies you deployed just won't apply. This is one of the most common issues in endpoint management, and in this guide, I'll show you exactly how to fix it.\n\n## The Symptoms\n\n- Device shows \"Sync in progress\" for hours/days\n- Policies don't apply even though deployment shows successful\n- Device appears in console but shows stale last check-in time\n- User complains their machine \"isn't getting updates\"\n\n## Why This Happens\n\nThe sync loop usually breaks because:\n1. **Network issues** blocking the check-in\n2. **Policy conflicts** causing the service to retry endlessly\n3. **Corrupted registry/certificates** on the device\n4. **Intune Service Synchronization Certificate** expired\n\nLet's fix it.\n\n## Method 1: Remote Sync from Intune Console\n\nThe easiest fix — try forcing a sync from the admin center.\n\n1. Go to **Devices** → **All devices**\n2. Select the stuck device\n3. Click **Sync** (top menu)\n\n> **Screenshot placeholder:** *Show the Sync button location in Endpoint Manager*\n\nIf this doesn't work, move to Method 2.\n\n## Method 2: Client-Side Sync (User-Initiated)\n\nOn the affected Windows device:\n\n1. Click **Start** → type **\"Company Portal\"**\n2. Open Company Portal app\n3. Click on **Devices**\n4. Select the device\n5. Click **Check Settings**\n\nThis triggers a check-in using the logged-in user's context.\n\n```powershell\n# Alternative: Trigger via PowerShell (as admin)\n# On the client machine\nStart-Process \"companyportal://syncdevice\"\n```\n\n## Method 3: Restart Intune Services\n\nSometimes the local services get stuck. Restart them:\n\n```powershell\n# Run as Administrator on the client\nRestart-Service -Name \"Intune Management Extension\" -Force\nStart-Sleep -Seconds 5\nStart-Service -Name \"Intune Management Extension\"\n\n# Also restart the MDMWaitron service\nRestart-Service -Name \"MDMWaitron\" -ErrorAction SilentlyContinue\n```\n\nThen try syncing again.\n\n## Method 4: Clear Cache and Re-register\n\nThis is the most effective fix for persistent sync issues:\n\n### Step 1: Remove Device from Intune\n\n```powershell\n# On client - get device ID\n$DeviceID = (Get-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Provisioning\\Diagnostics\\IntuneProvisioning\" -ErrorAction SilentlyContinue).AgentVersion\nif (-not $DeviceID) {\n    $DeviceID = (Get-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\MDM\\AutoEnrollMDM\" -ErrorAction SilentlyContinue).DeviceID\n}\nWrite-Host \"Device ID: $DeviceID\"\n```\n\n### Step 2: Clean Local Cache\n\n```powershell\n# Stop services\nGet-Service -Name \"Intune*\" | Stop-Service -Force\n\n# Remove cached data\nRemove-Item -Path \"$env:ProgramData\\Microsoft\\Intune\\*\" -Recurse -Force -Confirm:$false\n\n# Restart services  \nGet-Service -Name \"Intune*\" | Start-Service\n```\n\n### Step 3: Re-provision\n\n```powershell\n# Trigger re-provisioning\n\"C:\\Program Files\\Microsoft\\OnlineManagement\\ProvTool\\ProvTool.exe\" /Oobe /Q\n```\n\n## Method 5: Check for Certificate Issues\n\nExpired certificates are a common cause. Check on the client:\n\n```powershell\n# Check Intune certificate validity\nGet-ChildItem -Path \"Cert:\\LocalMachine\\My\" | Where-Object { $_.Subject -like \"*Intune*\" } | \n    Select-Object Subject, NotAfter, Thumbprint\n```\n\nIf expired:\n1. Go to **Settings** → **Access work or school**\n2. Disconnect the work/school account\n3. Re-enroll via **Settings** → **Accounts** → **Access work or school** → **Connect**\n\n## Method 6: Check for Policy Conflicts\n\nMultiple policies targeting the same setting can cause sync loops:\n\n1. In Intune, go to **Devices** → **Configuration profiles**\n2. Filter by the device platform\n3. Look for duplicate or conflicting profiles\n4. Check the device's **Device conflicts** view\n\n```powershell\n# Graph API: Get device conflict info\nGet-MgDeviceManagementManagedDevice -Filter \"deviceName eq 'TARGETDEVICE'\" | \n    Select-Object -ExpandProperty ConfigurationStates\n```\n\n## Prevention Tips\n\n1. **Don't deploy too many policies at once** — stagger deployments\n2. **Use groups wisely** — avoid rapid group changes\n3. **Monitor the Enrollment status** — catch issues early\n4. **Keep certificates updated** — check expiration quarterly\n\n## Wrap-Up\n\nStuck sync is frustrating but usually fixable. Start with a simple console sync, move to client-side restart, and go full cache clear if needed. \n\nNeed help? Leave a comment with what you're seeing.","src/content/articles/intune-stuck-sync-fixer.mdx","793089731e34c4bb","intune-stuck-sync-fixer.mdx","password-reset-scripts-it",{"id":276,"data":278,"body":284,"filePath":285,"digest":286,"legacyId":287,"deferredRender":31},{"title":279,"description":280,"publishedAt":16,"pillar":17,"difficulty":18,"type":19,"tags":281,"draft":26},"Password Reset Scripts for IT","Essential PowerShell scripts for password reset operations. Active Directory password management made easy.",[21,282,22,283,25],"password","reset","# Password Reset Scripts for IT\n\nPassword resets are one of the most common IT tasks. These scripts make it faster and more secure.\n\n## Reset User Password\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Reset AD user password\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$Username,\n    \n    [Parameter(Mandatory=$false)]\n    [switch]$MustChange\n)\n\n# Generate secure random password\n$Length = 16\n$Chars = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*\"\n$Password = -join ((1..$Length) | ForEach-Object { $Chars[(Get-Random -Maximum $Chars.Length)] })\n$SecurePassword = ConvertTo-SecureString $Password -AsPlainText -Force\n\n# Reset password\nSet-ADAccountPassword -Identity $Username -NewPassword $SecurePassword -Reset\n\nif ($MustChange) {\n    Set-ADUser -Identity $Username -ChangePasswordAtLogon $true\n}\n\nWrite-Host \"Password reset for: $Username\"\nWrite-Host \"Temp password: $Password\"\nWrite-Host \"Must change: $MustChange\"\n```\n\n## Bulk Password Reset\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Reset passwords for multiple users\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$CSVPath\n)\n\n$Users = Import-Csv $CSVPath\n\nforeach ($User in $Users) {\n    try {\n        $Password = -join ((1..12) | ForEach-Object { (33..126) | Get-Random | ForEach-Object { [char]$_ } })\n        $SecurePassword = ConvertTo-SecureString $Password -AsPlainText -Force\n        \n        Set-ADAccountPassword -Identity $User.SamAccountName -NewPassword $SecurePassword -Reset\n        Set-ADUser -Identity $User.SamAccountName -ChangePasswordAtLogon $true\n        \n        [PSCustomObject]@{\n            Username = $User.SamAccountName\n            Status = \"Success\"\n            TempPassword = $Password\n        }\n    }\n    catch {\n        [PSCustomObject]@{\n            Username = $User.SamAccountName\n            Status = \"Failed\"\n            Error = $_.Exception.Message\n        }\n    }\n}\n```\n\n## Check Password Expiry\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Check password age for users\n#>\nparam(\n    [Parameter(Mandatory=$false)]\n    [string]$OU\n)\n\n$Params = @{\n    Filter = \"*\"\n    Properties = \"PasswordLastSet\", \"PasswordExpired\", \"PasswordNeverExpires\"\n}\n\nif ($OU) {\n    $Params.SearchBase = $OU\n}\n\nGet-ADUser @Params | Select-Object Name, SamAccountName, PasswordLastSet, PasswordExpired, PasswordNeverExpires, @{N='DaysSince';E={(Get-Date) - $_.PasswordLastSet | Select-Object -ExpandProperty Days}}\n```\n\n## Force Password Change for Everyone\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Force all users to change password\n#>\nparam(\n    [Parameter(Mandatory=$false)]\n    [string]$ExcludeOU\n)\n\nGet-ADUser -Filter * -Properties PasswordLastSet | \n    Where-Object { -not $_.PasswordNeverExpires -and $_.DistinguishedName -notmatch $ExcludeOU } |\n    Set-ADUser -ChangePasswordAtLogon $true\n```\n\n## Password Report\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Generate password report\n#>\n$Report = Get-ADUser -Filter * -Properties PasswordLastSet, PasswordExpired, PasswordNeverExpires, LastLogonDate |\n    Select-Object Name, SamAccountName, \n        @{N='PasswordAge';E={(Get-Date) - $_.PasswordLastSet | Select-Object -ExpandProperty Days}},\n        PasswordExpired, PasswordNeverExpires, LastLogonDate\n\n$Report | Where-Object { $_.PasswordAge -gt 90 -and -not $_.PasswordNeverExpires } |\n    Export-Csv -Path \"C:\\Reports\\OldPasswords.csv\" -NoTypeInformation\n```\n\n## Wrap-Up\n\nThese scripts handle the most common password operations. Customize for your environment and audit regularly.\n\nQuestions? Drop them below!","src/content/articles/password-reset-scripts-it.mdx","ee715b5b83df4a61","password-reset-scripts-it.mdx","powershell-modules-guide",{"id":288,"data":290,"body":297,"filePath":298,"digest":299,"legacyId":300,"deferredRender":31},{"title":291,"description":292,"publishedAt":16,"pillar":17,"difficulty":18,"type":39,"tags":293,"draft":26},"PowerShell Modules: Install, Update, Use","Working with PowerShell modules. Install from PSGallery, update, and manage modules properly.",[21,294,295,296],"modules","psgallery","install","# PowerShell Modules: Install, Update, Use\n\nPowerShell's power comes from modules. Here's how to find, install, and manage them properly.\n\n## Finding Modules\n\n```powershell\n# Search PowerShell Gallery\nFind-Module -Name \"*Intune*\"\nFind-Module -Name \"*AzureAD*\"\nFind-Module -Name \"*PnP*\"\n\n# Search by tag\nFind-Module -Tag \"Azure\"\n```\n\n## Installing Modules\n\n```powershell\n# Install for current user (recommended)\nInstall-Module -Name \"Microsoft.Graph\" -Scope CurrentUser\n\n# Install for all users (requires admin)\nInstall-Module -Name \"Microsoft.Graph\" -Scope AllUsers\n\n# Install specific version\nInstall-Module -Name \"Microsoft.Graph\" -MinimumVersion \"2.0.0\" -MaximumVersion \"2.9.0\"\n```\n\n## Update Modules\n\n```powershell\n# Check for updates\nGet-Module -ListAvailable | Where-Object { $_.UpdateAvailable }\n\n# Update single module\nUpdate-Module -Name \"Microsoft.Graph\"\n\n# Update all\nUpdate-Module -Name \"*\"\n```\n\n## Trusted Repositories\n\n```powershell\n# Add trusted repository\nRegister-PSRepository -Name \"MyRepo\" -SourceLocation \"https://myrepo.com/nuget\" -InstallationPolicy Trusted\n\n# Set PSGallery to trusted (careful!)\nSet-PSRepository -Name \"PSGallery\" -InstallationPolicy Trusted\n```\n\n## Managing Modules\n\n```powershell\n# List installed modules\nGet-Module -ListAvailable\n\n# List imported modules in current session\nGet-Module\n\n# Import a module\nImport-Module \"Microsoft.Graph\"\n\n# Remove module from session\nRemove-Module \"Microsoft.Graph\"\n```\n\n## Common Modules You'll Need\n\n| Module | Purpose |\n|--------|---------|\n| Microsoft.Graph | Intune, Azure AD, M365 |\n| AzureAD | Legacy Azure AD |\n| PnP.PowerShell | SharePoint/Teams |\n| ImportExcel | Excel manipulation |\n| PSWriteHTML | HTML reports |\n| Pester | Testing |\n\n## Uninstall Old Versions\n\n```powershell\n# List all versions\nGet-InstalledModule -Name \"Microsoft.Graph\" -AllVersions\n\n# Remove old version\nUninstall-Module -Name \"Microsoft.Graph\" -RequiredVersion \"1.9.2\" -Force\n```\n\n## Module Best Practices\n\n1. **Scope CurrentUser** — Don't pollute system\n2. **Check signatures** — Only install signed modules\n3. **Pin versions** — Production scripts need stable versions\n4. **Document dependencies** — Note module versions in scripts\n\n## Wrap-Up\n\nModules extend PowerShell's capabilities. Install what you need, keep them updated, and be careful with repository trust settings.\n\nQuestions? Drop them below!","src/content/articles/powershell-modules-guide.mdx","f1749f9ca395a76b","powershell-modules-guide.mdx","powershell-remoting-troubleshooting",{"id":301,"data":303,"body":310,"filePath":311,"digest":312,"legacyId":313,"deferredRender":31},{"title":304,"description":305,"publishedAt":16,"pillar":17,"difficulty":38,"type":39,"tags":306,"draft":26},"PowerShell Remoting Troubleshooting Guide","Fix PowerShell Remoting (WinRM) connection issues. Get remote PS sessions working across your network.",[21,307,308,84,309],"winrm","remote","pssession","# PowerShell Remoting Troubleshooting Guide\n\nPowerShell Remoting is essential for remote management, but getting it working can be painful. This guide fixes the most common issues.\n\n## The Problem\n\nYou try:\n```powershell\nEnter-PSSession -ComputerName SERVER01\n```\n\nAnd get one of these errors:\n- \"WinRM cannot process the request\"\n- \"Access is denied\"\n- \"The client cannot connect to the destination\"\n- \"The remote server returned an error\"\n\n## Fix #1: Enable WinRM Service\n\n```powershell\n# On the REMOTE computer, run as Admin:\nStart-Service WinRM\nSet-Service -Name WinRM -StartupType Automatic\n\n# Or via registry (if service is blocked)\nSet-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\WinRM\" -Name \"Start\" -Value 3\n```\n\n## Fix #2: Quick Config Script\n\nMicrosoft provides a one-liner:\n\n```powershell\n# Run on remote computer as Admin\nEnable-PSRemoting -Force\n```\n\nThis:\n- Starts WinRM service\n- Creates firewall rules\n- Enables HTTP listener\n\n## Fix #3: Check WinRM Service Status\n\n```powershell\n# On remote computer\nGet-Service WinRM\nWinRM enumerate winrm/config/listener\n```\n\nShould show a listener on port 5985 (HTTP) or 5986 (HTTPS).\n\n## Fix #4: Firewall Rules\n\n```powershell\n# Check firewall\nGet-NetFirewallRule -Name \"*WinRM*\" | Select-Object Name, Enabled\n\n# Enable via PowerShell\nEnable-NetFirewallRule -Name \"Windows Remote Management (HTTP-In)\"\n```\n\n## Fix #5: Certificate Issues (HTTPS)\n\nIf using HTTPS (recommended):\n\n```powershell\n# Check existing certificate\nGet-ChildItem Cert:\\LocalMachine\\My | Where-Object { $_.Subject -like \"*$env:COMPUTERNAME*\" }\n\n# Create self-signed for testing\n$Cert = New-SelfSignedCertificate -DnsName $env:COMPUTERNAME -CertStoreLocation Cert:\\LocalMachine\\My\n\n# Add HTTPS listener\nNew-Item -Path WSMan:\\LocalHost\\Listener -Transport HTTPS -Address * -CertificateThumbprint $Cert.Thumbprint -Force\n```\n\n## Fix #6: Permission Issues\n\n```powershell\n# Check user is in Remote Management Users\nGet-LocalGroupMember -Group \"Remote Management Users\"\n\n# Add user if missing\nAdd-LocalGroupMember -Group \"Remote Management Users\" -Member \"DOMAIN\\User\"\n```\n\n## Fix #7: TrustedHosts (For Non-Domain)\n\nIf not using Kerberos:\n\n```powershell\n# On CLIENT computer\n# Add target to trusted hosts\nSet-Item -Path WSMan:\\localhost\\TrustedHosts -Value \"SERVER01,192.168.1.100\" -Force\n\n# Or allow all (less secure)\nSet-Item -Path WSMan:\\localhost\\TrustedHosts -Value \"*\" -Force\n```\n\n## Fix #8: Check Network Connectivity\n\n```powershell\n# Test basic connectivity\nTest-NetConnection -ComputerName SERVER01 -Port 5985\nTest-NetConnection -ComputerName SERVER01 -Port 5986\n\n# Test with specific auth\nTest-WSMan -ComputerName SERVER01\n```\n\n## Fix #9: Credential Issues\n\n```powershell\n# Use explicit credentials\n$Cred = Get-Credential\nEnter-PSSession -ComputerName SERVER01 -Credential $Cred\n\n# Or use CredSSP for double-hop\nEnable-WSManCredSSP -Role Client -DelegateComputer \"*.domain.com\"\n```\n\n## Fix #10: Group Policy Block\n\nCheck if GPO blocks WinRM:\n\n```powershell\n# Check local policy\ngpedit.msc → Computer Configuration → Administrative Templates → Windows Components → Windows Remote Management\n\n# Check domain policy\ngpresult /r | Select-String \"WinRM\"\n```\n\n## Quick Diagnostic Script\n\n```powershell\n# Run on the PROBLEM computer\nWrite-Host \"=== WinRM Status ===\"\nGet-Service WinRM | Select-Object Name, Status, StartType\n\nWrite-Host \"`n=== Listeners ===\"\nGet-ChildItem WSMan:\\localhost\\Listener | Select-Object Name, Value\n\nWrite-Host \"`n=== Firewall ===\"\nGet-NetFirewallRule -Name \"*WinRM*\" | Where-Object { $_.Enabled } | Select-Object Name\n\nWrite-Host \"`n=== TrustedHosts ===\"\nGet-Item WSMan:\\localhost\\TrustedHosts\n```\n\n## Wrap-Up\n\nMost WinRM issues come down to: service not running, firewall blocking, or permissions. Start with the basics and work up.\n\nNeed help? Leave a comment!","src/content/articles/powershell-remoting-troubleshooting.mdx","694961321a20de15","powershell-remoting-troubleshooting.mdx","powershell-win32-app-installers",{"id":314,"data":316,"body":320,"filePath":321,"digest":322,"legacyId":323,"deferredRender":31},{"title":317,"description":318,"publishedAt":16,"pillar":17,"difficulty":38,"type":19,"tags":319,"draft":26},"PowerShell Win32 App Installer Scripts","Essential PowerShell scripts for installing and managing Win32 apps in Intune. Automate your app deployment workflow.",[21,58,102,103,142],"# PowerShell Win32 App Installer Scripts\n\nDeploying Win32 apps in Intune is powerful but can be tricky. These scripts will help you package, install, and troubleshoot Win32 applications like a pro.\n\n## Script 1: Silent Install Wrapper\n\nEvery Win32 app needs a silent install. This wrapper handles the most common scenarios:\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Universal silent installer wrapper for Win32 apps\n    \n.PARAMETER InstallerPath\n    Full path to the installer file\n    \n.PARAMETER Arguments\n    Silent install arguments\n    \n.PARAMETER ExpectedExitCode\n    Expected exit code on success (default: 0)\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$InstallerPath,\n    \n    [Parameter(Mandatory=$false)]\n    [string]$Arguments = \"/S\",\n    \n    [Parameter(Mandatory=$false)]\n    [int]$ExpectedExitCode = 0\n)\n\n$ErrorActionPreference = \"Stop\"\n$LogFile = \"$env:TEMP\\Win32Install_$(Get-Date -Format 'yyyyMMdd_HHmmss').log\"\n\nfunction Write-Log {\n    param([string]$Message)\n    $Timestamp = Get-Date -Format 'yyyy-MM-dd HH:mm:ss'\n    $LogMessage = \"[$Timestamp] $Message\"\n    Write-Host $LogMessage\n    Add-Content -Path $LogFile -Value $LogMessage\n}\n\nWrite-Log \"Starting installation: $InstallerPath\"\nWrite-Log \"Arguments: $Arguments\"\n\ntry {\n    $Process = Start-Process -FilePath $InstallerPath -ArgumentList $Arguments -Wait -PassThru -NoNewWindow\n    \n    if ($Process.ExitCode -eq $ExpectedExitCode) {\n        Write-Log \"SUCCESS: Installation completed with exit code $($Process.ExitCode)\"\n        exit 0\n    } else {\n        Write-Log \"WARNING: Installation completed with unexpected exit code $($Process.ExitCode)\"\n        exit $Process.ExitCode\n    }\n}\ncatch {\n    Write-Log \"ERROR: $($_.Exception.Message)\"\n    exit 1\n}\n```\n\n**Usage:**\n```powershell\n.\\Install-App.ps1 -InstallerPath \"C:\\Apps\\7zip\\7zip-x64.msi\" -Arguments \"/quiet /norestart\"\n```\n\n## Script 2: Detection Rule Generator\n\nCreate detection rules for your Win32 apps automatically:\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Generate Intune detection rules for Win32 apps\n#>\n\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$AppName,\n    \n    [Parameter(Mandatory=$false)]\n    [ValidateSet(\"File\", \"Registry\", \"MSI\")]\n    [string]$DetectionType = \"File\",\n    \n    [Parameter(Mandatory=$true)]\n    [string]$DetectionPath,\n    \n    [Parameter(Mandatory=$false)]\n    [string]$DetectionVersion\n)\n\n$Rule = @{\n    \"@odata.type\" = \"#microsoft.graph.win32LobAppDetectionRule\"\n    ruleType = switch ($DetectionType) {\n        \"File\" { \"file\" }\n        \"Registry\" { \"registry\" }\n        \"MSI\" { \"productVersion\" }\n    }\n    path = $DetectionPath\n    fileOrFolderName = Split-Path $DetectionPath -Leaf\n}\n\nif ($DetectionVersion) {\n    $Rule[\"version\"] = $DetectionVersion\n    $Rule[\"operator\"] = \"greaterThanOrEqual\"\n}\n\n$DetectionRule = @{\n    rules = @($Rule)\n} | ConvertTo-Json -Depth 5\n\nWrite-Output $DetectionRule\n\n# Save to file for Intune Win32 import\n$DetectionRule | Out-File -FilePath \".\\$AppName-detection-rule.json\"\nWrite-Host \"Detection rule saved to .\\$AppName-detection-rule.json\"\n```\n\n## Script 3: Pre-Install System Check\n\nCheck prerequisites before installing:\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Pre-installation system checks for Win32 apps\n#>\n\n$ErrorActionPreference = \"Continue\"\n\nWrite-Host \"=== System Prerequisites Check ===\" -ForegroundColor Cyan\n\n$Checks = @{\n    \"Disk Space (C:)\" = {\n        $Drive = Get-PSDrive -Name C\n        [math]::Round($Drive.Free / 1GB, 2)\n    }\n    \"OS Version\" = {\n        (Get-CimInstance Win32_OperatingSystem).Caption\n    }\n    \"Architecture\" = {\n        $env:PROCESSOR_ARCHITECTURE\n    }\n    \"Intune Agent Version\" = {\n        (Get-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\IntuneAgent\" -ErrorAction SilentlyContinue).Version\n    }\n    \"PowerShell Version\" = {\n        $PSVersionTable.PSVersion.ToString()\n    }\n    \"Free RAM (GB)\" = {\n        [math]::Round((Get-CimInstance Win32_OperatingSystem).FreePhysicalMemory / 1MB, 2)\n    }\n}\n\n$AllPassed = $true\n\nforeach ($Check in $Checks.GetEnumerator()) {\n    $Result = & $Check.Value\n    $Status = if ($Result) { \"✓ PASS\" } else { \"✗ FAIL\" }\n    $Color = if ($Result) { \"Green\" } else { \"Red\" }\n    \n    Write-Host \"$($Check.Key): $Result - $Status\" -ForegroundColor $Color\n    \n    if (-not $Result -and $Check.Key -ne \"Free RAM (GB)\") {\n        $AllPassed = $false\n    }\n}\n\nif ($AllPassed) {\n    Write-Host \"`nAll checks passed!\" -ForegroundColor Green\n    exit 0\n} else {\n    Write-Host \"`nSome checks failed!\" -ForegroundColor Red\n    exit 1\n}\n```\n\n## Script 4: Uninstall Legacy App\n\nClean up old versions before installing new:\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Uninstall existing versions of an application\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$AppName,\n    \n    [Parameter(Mandatory=$false)]\n    [string[]]$UninstallStrings\n)\n\n$ErrorActionPreference = \"Continue\"\n\nWrite-Host \"Searching for existing $AppName installations...\" -ForegroundColor Yellow\n\n$InstalledApps = Get-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*,\n    HKLM:\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* -ErrorAction SilentlyContinue\n\n$FoundApps = $InstalledApps | Where-Object { $_.DisplayName -like \"*$AppName*\" }\n\nif ($FoundApps) {\n    foreach ($App in $FoundApps) {\n        Write-Host \"Found: $($App.DisplayName) - $($App.Version)\"\n        \n        if ($App.UninstallString) {\n            Write-Host \"Uninstalling...\"\n            \n            $UninstallString = $App.UninstallString\n            \n            # Handle different uninstall formats\n            if ($UninstallString -match \"msiexec\") {\n                $UninstallString += \" /qn /norestart\"\n            }\n            \n            Start-Process -FilePath \"cmd.exe\" -ArgumentList \"/c $($UninstallString)\" -Wait -NoNewWindow\n            Write-Host \"Uninstalled successfully\"\n        }\n    }\n} else {\n    Write-Host \"No existing installations found\" -ForegroundColor Green\n}\n```\n\n## Script 5: Post-Install Validation\n\nVerify the app installed correctly:\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Post-installation validation\n#>\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$AppName,\n    \n    [Parameter(Mandatory=$false)]\n    [string[]]$VerificationPaths\n)\n\nWrite-Host \"Validating $AppName installation...\" -ForegroundColor Cyan\n\n$ValidationPassed = $true\n\nforeach ($Path in $VerificationPaths) {\n    if (Test-Path $Path) {\n        Write-Host \"✓ Found: $Path\" -ForegroundColor Green\n    } else {\n        Write-Host \"✗ Missing: $Path\" -ForegroundColor Red\n        $ValidationPassed = $false\n    }\n}\n\n# Check registry\n$RegPath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\*\"\n$RegApps = Get-ItemProperty $RegPath -ErrorAction SilentlyContinue | Where-Object { $_.DisplayName -like \"*$AppName*\" }\n\nif ($RegApps) {\n    Write-Host \"✓ Registry entry found\" -ForegroundColor Green\n} else {\n    Write-Host \"⚠ No registry entry (may be normal)\" -ForegroundColor Yellow\n}\n\nif ($ValidationPassed) {\n    Write-Host \"`n✓ Validation PASSED\" -ForegroundColor Green\n    exit 0\n} else {\n    Write-Host \"`n✗ Validation FAILED\" -ForegroundColor Red\n    exit 1\n}\n```\n\n## Wrap-Up\n\nThese scripts cover the full Win32 app lifecycle in Intune. Save them to your toolkit and customize for each app deployment.","src/content/articles/powershell-win32-app-installers.mdx","7ea26f507ef5da2a","powershell-win32-app-installers.mdx","remote-desktop-troubleshooting",{"id":324,"data":326,"body":332,"filePath":333,"digest":334,"legacyId":335,"deferredRender":31},{"title":327,"description":328,"publishedAt":16,"pillar":84,"difficulty":18,"type":39,"tags":329,"draft":26},"Remote Desktop Troubleshooting Guide","Fix Remote Desktop connection issues. RDP not working? Can't connect? Here's the complete fix guide.",[330,331,84,243],"rdp","remote-desktop","# Remote Desktop Troubleshooting Guide\n\nRDP not connecting? Can't remote to that server? Here's how to diagnose and fix Remote Desktop issues.\n\n## Quick Checklist\n\n- [ ] RDP enabled on target\n- [ ] Network allows port 3389\n- [ ] User in Remote Desktop Users\n- [ ] Firewall not blocking\n- [ ] NLA configured correctly\n\n## Enable RDP\n\n```powershell\n# Enable RDP (Local)\nSet-ItemProperty -Path \"HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server\" -Name \"fDenyTSConnections\" -Value 0\n\n# Enable RDP through firewall\nEnable-NetFirewallRule -Name \"RemoteDesktop-TCP\"\nEnable-NetFirewallRule -Name \"RemoteDesktop-UDP\"\n```\n\n## Check RDP Status\n\n```powershell\n# Check if RDP is enabled\nGet-ItemProperty -Path \"HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server\" -Name \"fDenyTSConnections\"\n\n# Check listening port\nGet-ItemProperty -Path \"HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" -Name \"PortNumber\"\n```\n\n## Add User to RDP Users\n\n```powershell\n# Add user to Remote Desktop Users\nAdd-LocalGroupMember -Group \"Remote Desktop Users\" -Member \"Username\"\n\n# Or via AD\nAdd-ADGroupMember -Identity \"Remote Desktop Users\" -Members \"Username\"\n```\n\n## Network Level Authentication\n\n```powershell\n# NLA required (more secure, can cause issues)\n# Check NLA status\nGet-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" -Name \"UserAuthentication\"\n\n# Disable NLA (less secure, troubleshooting)\nSet-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" -Name \"UserAuthentication\" -Value 0\n```\n\n## Common Errors\n\n### \"Remote computer is not available\"\n\n```powershell\n# Test connectivity\nTest-NetConnection -ComputerName \"TargetPC\" -Port 3389\n\n# Ping test\nTest-Connection -ComputerName \"TargetPC\"\n```\n\n### \"Logon attempt failed\"\n\n- Wrong credentials\n- Account disabled\n- Account expired\n- NLA issue\n\n### \"The remote session was disconnected\"\n\n- License issues (RDS)\n- Too many connections\n- Network interruption\n\n## Check RDS Licensing\n\n```powershell\n# Check RDS license server\nGet-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\TermService\\Parameters\" -Name \"LicenseServer\"\n\n# Check installed licenses\nGet-WmiObject -Class \"Win32_TSLicenseKeyPack\"\n```\n\n## Fix Corrupted RDP\n\n```powershell\n# Reset RDP stack\nRemove-Item -Path \"HKCU:\\Software\\Microsoft\\Terminal Server Client\" -Recurse -Force\n\n# Delete RDP certificates\nRemove-Item -Path \"HKLM:\\Software\\Microsoft\\Terminal Server Client\\Default\" -Recurse -Force\n```\n\n## Wrap-Up\n\nMost RDP issues are firewall, permission, or NLA-related. Check connectivity first, then work through the list.\n\nQuestions? Drop them below!","src/content/articles/remote-desktop-troubleshooting.mdx","207860e2e08223c8","remote-desktop-troubleshooting.mdx","setup-home-lab-it-learning",{"id":336,"data":338,"body":348,"filePath":349,"digest":350,"legacyId":351,"deferredRender":31},{"title":339,"description":340,"publishedAt":16,"pillar":341,"difficulty":18,"type":39,"tags":342,"draft":26},"Setup Your Home Lab for IT Learning","Build a budget-friendly home lab for learning Windows administration, PowerShell, Intune, and more. Hardware recommendations and setup guide.","career",[343,344,345,346,347,341],"lab","homelab","hyper-v","virtualization","learning","# Setup Your Home Lab for IT Learning\n\nYou want to learn Windows administration, Intune, PowerShell, but you need a lab. Here's how to build one on a budget.\n\n## The Minimal Lab ($0-50)\n\n### What You Need\n- Your current PC (8GB RAM minimum, 16GB recommended)\n- Free hypervisor: Hyper-V (Windows Pro) or VirtualBox (any Windows)\n\n### Setup\n\n```powershell\n# Check if Hyper-V is available (Windows Pro/Enterprise)\nGet-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V-All\n\n# Enable Hyper-V\nEnable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V-All -NoRestart\n```\n\n### VMs to Create\n1. **DC01** — Windows Server 2022 (Domain Controller)\n2. **CLIENT01** — Windows 11 (joined to domain)\n3. **SRV01** — Windows Server 2022 (file/app server)\n\n## The Better Lab ($100-200)\n\n### Hardware Recommendations\n\n| Component | Budget Option | Better Option |\n|----------|--------------|--------------|\n| CPU | Intel i5-10400 | Intel i7-12700K |\n| RAM | 32GB | 64GB |\n| Storage | 500GB SSD | 1TB NVMe |\n| Network | Built-in | Dual NIC |\n\n### Pro Tips\n- Buy used enterprise hardware (Dell Optiplex, HP ProDesk)\n- Get machines with vPro/AmT for remote management\n\n## Essential VMs to Build\n\n### 1. Domain Controller\n```powershell\n# Install AD DS\nInstall-WindowsFeature AD-Domain-Services -IncludeManagementTools\n\n# Promote to DC\nImport-Module ADDSDeployment\nInstall-ADDSForest -DomainName \"lab.local\" -SafeModeAdministratorPassword (ConvertTo-SecureString \"P@ssw0rd!\" -AsPlainText -Force)\n```\n\n### 2. Intune Connector Server\n- Windows Server 2022\n- Install Azure AD Connect\n- Install Intune Certificate Connector\n\n### 3. Clients\n- Windows 11 Enterprise (eval ISO)\n- Windows 10 Enterprise\n\n## Software to Install\n\n### Free Windows ISOs\n- [Windows Evaluation Center](https://www.microsoft.com/en-us/evalcenter/)\n- [Windows Server Evaluation](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2025)\n\n### Tools to Have\n- **VS Code** — Script editing\n- **Remote Server Administration Tools (RSAT)** — Management\n- **Hyper-V Manager** — VM management\n- **Pester** — Testing PowerShell\n\n## Network Setup\n\n### Recommended Network\n```\n[Router] \n  |\n  +-- [Hyper-V Host]\n  |     +-- DC01 (Server 2022, 4GB RAM)\n  |     +-- CLIENT01 (Win11, 4GB RAM)  \n  |     +-- CLIENT02 (Win11, 4GB RAM)\n  |     +-- SRV01 (Server 2022, 4GB RAM)\n```\n\n### Switch to Use\n- **Physical**: Unmanaged gigabit switch ($20)\n- **Virtual**: Default Switch in Hyper-V\n\n## Learning Path\n\n### Week 1-2: Active Directory\n- Create users, groups, OUs\n- Group Policy basics\n- DNS, DHCP\n\n### Week 3-4: PowerShell\n- Script AD tasks\n- Build automation\n\n### Week 5-6: Intune\n- Enroll devices\n- Deploy policies\n- App packaging\n\n### Week 7-8: Security\n- BitLocker\n- Conditional Access\n- Endpoint Security\n\n## Wrap-Up\n\nYou don't need expensive gear to learn. Start with what you have, add RAM, and build out incrementally.\n\nQuestions? Drop them below!","src/content/articles/setup-home-lab-it-learning.mdx","367915b4cf4dd607","setup-home-lab-it-learning.mdx","windows-autopilot-complete-guide",{"id":352,"data":354,"body":359,"filePath":360,"digest":361,"legacyId":362,"deferredRender":31},{"title":355,"description":356,"publishedAt":16,"pillar":100,"difficulty":38,"type":39,"tags":357,"draft":26},"Windows Autopilot: The Complete Guide","Everything you need to know about Windows Autopilot. From profile creation to device enrollment, covered.",[192,58,100,358,191],"oobe","# Windows Autopilot: The Complete Guide\n\nWindows Autopilot is Microsoft's modern deployment solution. Here's everything you need to know.\n\n## What is Autopilot?\n\nA cloud-based deployment service that:\n- Transforms new devices from \"blank\" to \"ready to use\"\n- Requires no IT infrastructure\n- Configures devices via Intune\n\n## Deployment Modes\n\n### User-Driven\n- Traditional OOBE experience\n- User logs in with corporate credentials\n- Device joins Azure AD and enrolls in Intune\n\n### Self-Deploying (Zero-Touch)\n- No user interaction required\n- Device provisions itself\n- Great for kiosks, digital signage\n\n### White Glove\n- IT pre-provisions device\n- User gets fresh out-of-box experience\n\n## Getting Started\n\n### Step 1: Register Devices\n\n```powershell\n# Get hardware hash\nGet-WindowsAutoPilotInfo -Computer . | Export-CSV -Path \".\\hardwarehash.csv\"\n\n# Or use CSV import in Intune\n```\n\n### Step 2: Create Profile\n\n1. Go to **Intune** → **Devices** → **Windows** → **Autopilot deployment profiles**\n2. **Create profile**\n3. Configure settings:\n   - Join type: Azure AD joined\n   - Out-of-box experience: User-driven\n   - Language: Match device\n   - Account type: Standard user\n\n### Step 3: Assign Profile\n\n- Assign to device group\n- Or auto-assign based on order ID\n\n## Profile Settings\n\n| Setting | Options |\n|---------|---------|\n| Deployment mode | User-driven / Self-deploying |\n| Join to | Azure AD |\n| Out-of-box experience | Full customization |\n| Language | en-US, etc. |\n| Keyboard | Primary + login |\n| Device name template | CORP-%SERIAL% |\n\n## Device Preparation\n\n### For Self-Deploying Mode\n- TPM 2.0 required\n- Ethernet recommended\n- Wired connection for initial setup\n\n### For User-Driven\n- Works over WiFi\n- User needs credentials\n\n## Troubleshooting\n\n### Profile Not Applying\n\n```powershell\n# Check device enrollment\ndsregcmd /status\n\n# Check Autopilot state\nGet-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Provisioning\\Diagnostics\\Autopilot\"\n```\n\n### Device Not Showing\n\n- Import hardware hash again\n- Check assigned group\n- Verify profile status\n\n## Autopilot Reset\n\n```powershell\n# Local reset (preserve enrollment)\nReset-AzureAutopilotDevice -DeviceId \"device-id\"\n\n# Full reset (wipe and re-enroll)\nWipe-AzureAutopilotDevice -DeviceId \"device-id\"\n```\n\n## Wrap-Up\n\nAutopilot transforms device deployment. Start with user-driven mode, then explore self-deploying as you mature.\n\nQuestions? Drop them below!","src/content/articles/windows-autopilot-complete-guide.mdx","3747b592787cfca3","windows-autopilot-complete-guide.mdx","windows-event-log-essentials",{"id":363,"data":365,"body":372,"filePath":373,"digest":374,"legacyId":375,"deferredRender":31},{"title":366,"description":367,"publishedAt":16,"pillar":84,"difficulty":18,"type":39,"tags":368,"draft":26},"Windows Event Log Essentials for IT","The essential Windows Event Logs every IT pro should monitor. Learn to read, filter, and act on Windows logs effectively.",[44,369,84,370,371],"event-logs","event-viewer","monitoring","# Windows Event Log Essentials for IT\n\nWhen something breaks, the Event Logs are your first stop. But there's a lot of noise in there. This guide covers the essential logs you need to monitor and how to read them effectively.\n\n## The Big Five Logs\n\n### 1. System Log\n**Location:** `Application and Services Logs\\Microsoft\\Windows\\EventID\\...`\n\nWhat you'll find:\n- Driver failures\n- Service starts/stops\n- Hardware issues\n- Blue Screen events (BugCheck)\n\n```powershell\n# Quick System log check\nGet-WinEvent -LogName System -MaxEvents 50 | \n    Where-Object { $_.LevelDisplayName -eq 'Error' } | \n    Select-Object TimeCreated, Id, Message\n```\n\n### 2. Application Log\n\nWhat you'll find:\n- Application crashes\n- .NET errors\n- Software installation issues\n\n```powershell\n# Recent application errors\nGet-WinEvent -LogName Application -MaxEvents 20 |\n    Where-Object { $_.Level -eq 2 } |\n    Select-Object TimeCreated, ProviderName, Message\n```\n\n### 3. Security Log\n\nWhat you'll find:\n- Logon events (4624, 4625)\n- Account changes (4728, 4729)\n- Privilege use (4672)\n- Failed password attempts\n\n```powershell\n# Recent successful logons\nGet-WinEvent -LogName Security -FilterHashtable @{\n    ID = 4624\n    TimeCreated = (Get-Date).AddHours(-24)\n} -MaxEvents 10 | Select-Object TimeCreated, @{N='User';E={$_.Properties[5].Value}}\n\n# Failed logon attempts\nGet-WinEvent -LogName Security -FilterHashtable @{\n    ID = 4625\n    TimeCreated = (Get-Date).AddHours(-24)\n} -MaxEvents 10\n```\n\n### 4. Setup Log\n\nWhat you'll find:\n- Windows Update issues\n- Installation failures\n- Component store corruption\n\n```powershell\n# Setup log location\n$SetupLog = \"$env:SystemRoot\\Panther\\setupact.log\"\nGet-Content $SetupLog -Tail 50\n```\n\n### 5. Microsoft-Windows-DeviceManagement-Enterprise-Diagnostics-Provider/Admin\n\nWhat you'll find:\n- Intune enrollment issues\n- MDM sync problems\n- Policy deployment failures\n\n```powershell\n# Intune/MDM logs\nGet-WinEvent -LogName \"Microsoft-Windows-DeviceManagement-Enterprise-Diagnostics-Provider/Admin\" -MaxEvents 20\n```\n\n## Essential Event IDs to Know\n\n### Security\n| Event ID | Meaning |\n|----------|---------|\n| 4624 | Successful logon |\n| 4625 | Failed logon |\n| 4634 | Logoff |\n| 4672 | Special privileges assigned |\n| 4720 | User account created |\n| 4726 | User account deleted |\n\n### System\n| Event ID | Meaning |\n|----------|---------|\n| 6005 | Event Log service started |\n| 6006 | Event Log service stopped |\n| 6008 | Unexpected shutdown |\n| 7036 | Service state changed |\n| 7045 | New service installed |\n\n## PowerShell Log Queries\n\n### The \"Something Broke\" Starter Pack\n\n```powershell\n# Everything error-level from last 24 hours\nGet-WinEvent -FilterHashtable @{\n    LogName = 'System', 'Application'\n    Level = 2\n    StartTime = (Get-Date).AddDays(-1)\n} -MaxEvents 100\n\n# Find crashes\nGet-WinEvent -FilterHashtable @{LogName='Application'; StartTime=(Get-Date).AddDays(-7)} |\n    Where-Object { $_.Message -match \"faulting|exception|error\" } |\n    Select-Object TimeCreated, ProviderName, Message\n```\n\n### Monitor a Specific Service\n\n```powershell\n# Track a service\n$ServiceName = \"W32Time\"\nGet-WinEvent -FilterHashtable @{\n    LogName = 'System'\n    ProviderName = 'Microsoft-Windows-Time-Service'\n} -MaxEvents 50\n```\n\n## Remote Log Collection\n\n```powershell\n# Collect from remote computer\nInvoke-Command -ComputerName \"TARGET-PC\" -ScriptBlock {\n    Get-WinEvent -LogName System -MaxEvents 20 -ErrorAction SilentlyContinue\n} | Select-Object TimeCreated, MachineName, Message\n```\n\n## Pro Tips\n\n1. **Create custom views** — Filter once, save the view\n2. **Use XML queries** — More powerful filtering\n3. **Export to CSV** — For analysis\n4. **Set up subscriptions** — Central collection with Windows Event Forwarding\n\n## Wrap-Up\n\nThe Event Logs are your friend. Know your Event IDs, build good queries, and you'll diagnose issues faster.\n\nQuestions? Drop them below!","src/content/articles/windows-event-log-essentials.mdx","3a1b6305e49bf625","windows-event-log-essentials.mdx","windows-first-signin-restore-fix",{"id":376,"data":378,"body":385,"filePath":386,"digest":387,"legacyId":388,"deferredRender":31},{"title":379,"description":380,"publishedAt":16,"pillar":84,"difficulty":38,"type":39,"tags":381,"draft":26},"Fix Windows First Sign-In After Sysprep","Troubleshooting Windows first-sign-in experience after Sysprep or imaging. Fix OOBE issues and profile creation errors.",[44,382,358,383,127,384],"sysprep","imaging","first-signin","# Fix Windows First Sign-In After Sysprep\n\nYou image a machine, boot it up, and instead of getting to the desktop, you're stuck in the first-sign-in (OOBE) loop. Or maybe you get past OOBE but the profile doesn't create properly. This is a classic imaging problem — and it has some classic fixes.\n\n## The Symptoms\n\n- Windows boots to \"Let's connect you to a network\" screen repeatedly\n- Stuck on \"Just a moment...\" for hours\n- Profile doesn't create — you get a temp profile\n- \"The user profile service failed the logon\"\n- OOBE crashes or hangs\n\n## Fix #1: Clear Previous Provisioning Data\n\nThe most common cause — Windows thinks it's already been set up.\n\n```powershell\n# From WinPE or recovery\n# Mount the image and run:\ndism /Image:C:\\ /Cleanup-Image /ScanHealth\ndism /Image:C:\\ /Cleanup-Image /RestoreHealth\n\n# Or on the local machine (run as admin)\nGet-AppxProvisionedPackage -Online | Remove-AppxProvisionedPackage -AllUsers\n```\n\n## Fix #2: Delete SID and Provisioning Files\n\n```powershell\n# Navigate to:\nC:\\Users\\Default\\AppData\\Local\\Microsoft\\Windows\n\n# Delete these folders if they exist:\n# - ShellExperienceHost\n# - TileStore\n# - WebView2\n\n# Also delete:\nC:\\Windows\\System32\\Sysprep\\Panther\\*\n```\n\n## Fix #3: Reset OOBE\n\n```powershell\n# From WinPE or recovery environment\n# Run:\nsystemreset -cleanboot\n\n# Or:\nmdmdiagnostics.exe -o C:\\Logs\n```\n\n## Fix #4: Network Profile Reset\n\nSometimes stuck on network screen due to cached profiles:\n\n```powershell\n# Boot to WinPE, mount the image:\ndism /mount-image /imagefile:C:\\mount\\winpe.wim /index:1 /mountdir:C:\\mount\n\n# Delete network profiles:\ndel C:\\mount\\Windows\\System32\\config\\systemprofile\\AppData\\Local\\Microsoft\\Windows\\NlaCache\\*\n\n# Unmount and commit:\ndism /unmount-image /mountdir:C:\\mount /commit\n```\n\n## Fix #5: Fix User Profile Corruption\n\nIf the profile fails to create:\n\n```powershell\n# Delete corrupted profile data\nRemove-Item -Path \"C:\\Users\\Default\" -Recurse -Force -ErrorAction SilentlyContinue\n\n# Rebuild default profile\n# Copy from:\n$env:SystemRoot\\System32\\Config\\SystemProfile\n# To:\n$env:SystemRoot\\Users\\Default\n\n# Fix permissions\nicacls C:\\Users\\Default /reset /T\n```\n\n## Fix #6: Check Unattend.xml\n\nIf you're using an answer file, it might be malformed:\n\n```powershell\n# Validate unattend.xml\n# Location: C:\\Windows\\Panther\\unattend.xml\n\n# Check for:\n# - EnableNetworkProvisioning = true\n# - HideEULAPage = true\n# - HideWirelessSetupInOOBE = true\n# - NetworkLocation = Work\n# - ProtectYourPC = 1\n```\n\n## Fix #7: General Sysprep Best Practice\n\nHere's the proper sysprep sequence:\n\n```powershell\n# 1. Run Sysprep with generalize and shutdown\nsysprep /generalize /oobe /shutdown /quiet\n\n# 2. Capture with DISM\ndism /capture-image /imagefile:C:\\captures\\myimage.wim /capture:C:\\ /name:\"Windows 11\" /compress:fast\n\n# 3. Deploy\ndism /apply-image /imagefile:C:\\captures\\myimage.wim /index:1 /applydir:C:\\\nbcdboot C:\\Windows /s C:\n```\n\n## Fix #8: VM-Specific Issues\n\nIf imaging a VM (Hyper-V, VMware):\n\n```powershell\n# Disable Network Adapter teaming/hypervisor features\n# In the VM, run:\nbcdedit /set hypervisorlaunchtype off\n\n# Or add to answer file:\n\u003CNetworkAdapter>\n    \u003CMetaData>\n        \u003CKey>Sysprep.HyperV.Deploy\u003C/Key>\n        \u003CValue>False\u003C/Value>\n    \u003C/MetaData>\n\u003C/NetworkAdapter>\n```\n\n## Quick Checklist\n\n- [ ] Clear provisioning data\n- [ ] Delete Panther folder\n- [ ] Validate unattend.xml\n- [ ] Check network drivers\n- [ ] Verify disk space\n- [ ] Reset OOBE\n\n## Wrap-Up\n\nFirst-sign-in issues are almost always related to Sysprep not running correctly or cached data from the source machine. Follow the fixes above systematically.\n\nNeed help? Leave a comment!","src/content/articles/windows-first-signin-restore-fix.mdx","d2db284695824f95","windows-first-signin-restore-fix.mdx","windows-update-business-deployment",{"id":389,"data":391,"body":398,"filePath":399,"digest":400,"legacyId":401,"deferredRender":31},{"title":392,"description":393,"publishedAt":16,"pillar":100,"difficulty":38,"type":39,"tags":394,"draft":26},"Windows Update for Business Deployment","Configure Windows Update for Business in Intune. Manage feature and quality updates, deployment rings, and deferral.",[395,58,396,397],"windows-update","deployment-rings","updates","# Windows Update for Business Deployment\n\nManaging Windows updates in enterprise requires a strategy. Windows Update for Business Deployment in Intune gives you control over when and how updates are installed.\n\n## Understanding Update Types\n\n### Quality Updates\n- Security patches\n- Bug fixes\n- Released monthly (Patch Tuesday)\n- Mandatory\n\n### Feature Updates\n- New Windows versions (22H2 → 23H2)\n- Released bi-annually\n- Optional but recommended\n\n## Creating Deployment Rings\n\n### Ring 1: Pilot (IT)\n```powershell\n# Create via Intune or Graph\n$RingParams = @{\n    DisplayName = \"Pilot - IT\"\n    RingType = \"featureUpdate\"\n    TargetVersion = \"Windows 11 24H2\"\n    DeferralDays = 0\n    OfferDays = 0\n}\n```\n\n### Ring 2: Fast\n- Defer 7 days\n- IT and power users\n\n### Ring 3: Broad\n- Defer 14-30 days\n- General users\n\n### Ring 4: Critical\n- Defer 60+ days\n- Security only\n\n## Configuring Update Policies\n\n### Quality Update Policy\n```powershell\n# Via Intune:\n# Devices → Windows → Update rings → Create\n\n# Key settings:\n# - Automatic update behavior: Auto-install and restart\n# - Active hours start/end: Configure user work hours\n# - Days until deferral: 0-4 weeks\n# - Require user input: Yes/No\n```\n\n### Feature Update Policy\n```powershell\n# Devices → Windows → Feature updates → Create\n\n# Settings:\n# - Target version: Windows 11 24H2\n# - Deferral days: 0-365\n# - Offer days: 0-28 after release\n```\n\n## Business Hours Configuration\n\n```powershell\n# Configure active hours\n# This prevents restarts during work hours\n# \n# Recommended:\n# - Start: 8:00 AM\n# - End: 6:00 PM\n# - User control: Allow\n```\n\n## Driver Updates\n\n```powershell\n# Enable driver updates\n# Devices → Configuration profiles → Delivery Optimization\n# \n# Settings:\n# - Download mode: LAN (1)\n# - Enable peer caching: Yes\n# - Maximum cache size: 10-50%\n```\n\n## Managing Restarts\n\n```powershell\n# Configure restart behavior\n# \n# Options:\n# - Auto restart after update: Yes\n# - Restart check frequency: Hourly\n# - Bypass active hours: No\n# - User can pause: Yes/No\n```\n\n## Delivery Optimization\n\nReduces bandwidth by using peer caching:\n\n```powershell\n# Enable via Group Policy or Intune\n# \n# Download modes:\n# 0 = BITS\n# 1 = HTTP only, no peering\n# 2 = HTTP blended with LAN\n# 3 = HTTP blended with WAN\n# 99 = Simple download mode\n# 100 = BITS only\n```\n\n## Monitoring Updates\n\n```powershell\n# Check update status via Graph\nGet-MgDeviceManagementWindowsQualityUpdate -All | \n    Select-Object DisplayName, ComponentName, KBNumber, DeploymentDate\n\n# Check device compliance\nGet-MgDeviceManagementManagedDevice -All | \n    Where-Object { $_.osVersion -like \"*22H2*\" }\n```\n\n## Common Issues\n\n### Updates Not Installing\n- Check network connectivity\n- Verify disk space (minimum 10GB)\n- Check for conflicting policies\n\n### Restart Loop\n- Configure active hours\n- Enable \"Notify user\"\n\n### Drivers Reverting\n- Exclude drivers from updates\n- Use specific driver versions\n\n## Best Practices\n\n1. **Start with pilot ring** — Test before broad deployment\n2. **Monitor closely** — Check for issues in first week\n3. **Communicate with users** — Tell them when updates happen\n4. **Keep rings staggered** — Don't deploy to everyone at once\n\n## Wrap-Up\n\nWindows Update for Business gives enterprise control. Use deployment rings, configure active hours, and monitor closely.\n\nQuestions? Drop them below!","src/content/articles/windows-update-business-deployment.mdx","e7a40a319c2e5302","windows-update-business-deployment.mdx","scripts",["Map",404,405],"remove-old-user-profiles",{"id":404,"data":406,"body":409,"filePath":410,"digest":411,"legacyId":412,"deferredRender":31},{"title":407,"description":408,"language":21,"pillar":17,"publishedAt":16,"draft":26},"Remove Old User Profiles","PowerShell script to remove stale user profiles from Windows machines.","# Remove Old User Profiles\n\nThis script removes user profiles older than a specified number of days from Windows machines.\n\n## Usage\n\n```powershell\n.\\Remove-OldProfiles.ps1 -DaysOld 90 -WhatIf\n```\n\n## Parameters\n\n- **DaysOld**: Number of days since last logon (default: 90)\n- **WhatIf**: Preview what would be deleted without actually deleting\n- **Force**: Skip confirmation prompts\n\n## Script\n\n```powershell\n\u003C#\n.SYNOPSIS\n    Remove old user profiles from Windows machines.\n    \n.DESCRIPTION\n    This script removes user profiles that haven't been logged into for a specified number of days.\n    Supports -WhatIf mode for safe testing.\n    \n.PARAMETER DaysOld\n    Number of days since last logon (default: 90)\n    \n.PARAMETER WhatIf\n    Preview what would be deleted without actually deleting\n    \n.PARAMETER Force\n    Skip confirmation prompts\n    \n.EXAMPLE\n    .\\Remove-OldProfiles.ps1 -DaysOld 90 -WhatIf\n    \n.EXAMPLE\n    .\\Remove-OldProfiles.ps1 -DaysOld 60 -Force\n#>\n\n[CmdletBinding(SupportsShouldProcess)]\nparam(\n    [Parameter(Mandatory=$false)]\n    [int]$DaysOld = 90,\n    \n    [Parameter(Mandatory=$false)]\n    [switch]$Force\n)\n\n$LogFile = \"$env:TEMP\\ProfileCleanup_$(Get-Date -Format 'yyyyMMdd_HHmmss').log\"\n\nfunction Write-Log {\n    param([string]$Message)\n    $Timestamp = Get-Date -Format 'yyyy-MM-dd HH:mm:ss'\n    $LogMessage = \"[$Timestamp] $Message\"\n    Write-Host $LogMessage\n    Add-Content -Path $LogFile -Value $LogMessage\n}\n\nWrite-Log \"Starting profile cleanup. DaysOld: $DaysOld\"\n\n# Get all user profiles\n$Profiles = Get-CimInstance -ClassName Win32_UserProfile | \n    Where-Object { $_.LocalPath -notmatch '^(C:|D:|E:|F:)\\\\Users\\\\(Public|Default|Administrator|System)' }\n\n$CutoffDate = (Get-Date).AddDays(-$DaysOld)\n$ToDelete = @()\n\nforeach ($Profile in $Profiles) {\n    $LastUse = $Profile.LastUseTime\n    $Username = $Profile.LocalPath -replace '.*\\\\', ''\n    \n    if ($LastUse -and $LastUse -lt $CutoffDate) {\n        $ToDelete += [PSCustomObject]@{\n            Username = $Username\n            LastUsed = $LastUse\n            Path = $Profile.LocalPath\n            DaysSince = ((Get-Date) - $LastUse).Days\n        }\n    }\n}\n\nif ($ToDelete.Count -eq 0) {\n    Write-Log \"No profiles older than $DaysOld days found.\"\n    exit 0\n}\n\nWrite-Log \"Found $($ToDelete.Count) profiles to remove:\"\n$ToDelete | ForEach-Object { Write-Log \"  - $($_.Username) (last used: $($_.LastUsed), $($_.DaysSince) days ago)\" }\n\nif ($WhatIfPreference -or $PSCmdlet.ShouldProcess(\"Delete $($ToDelete.Count) profiles\")) {\n    if ($Force -or $PSCmdlet.ShouldContinue(\"Delete $($ToDelete.Count) old profiles?\", \"Confirm Deletion\")) {\n        foreach ($Profile in $ToDelete) {\n            try {\n                # Remove the profile using WMI\n                $Profile | Remove-CimInstance -ErrorAction Stop\n                Write-Log \"DELETED: $($Profile.Username)\"\n            }\n            catch {\n                Write-Log \"ERROR deleting $($Profile.Username): $_\"\n            }\n        }\n    }\n}\n\nWrite-Log \"Profile cleanup complete. Log saved to: $LogFile\"\n```\n\n## Important Notes\n\n1. **Always run with -WhatIf first** to see what will be deleted\n2. **Excluded accounts**: Public, Default, Administrator, System profiles are always preserved\n3. **Requires admin rights** to delete profiles\n4. **Logged actions** are saved to a log file in TEMP\n\n## Automation\n\nTo run as a scheduled task:\n\n```powershell\n$Action = New-ScheduledTaskAction -Execute 'Powershell.exe' -Argument '-NoProfile -ExecutionPolicy Bypass -File C:\\Scripts\\Remove-OldProfiles.ps1 -DaysOld 90 -Force'\n$Trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Sunday -At 3AM\nRegister-ScheduledTask -TaskName 'Cleanup Old Profiles' -Action $Action -Trigger $Trigger -RunLevel Highest\n```","src/content/scripts/remove-old-user-profiles.mdx","fd43cc79e5219c55","remove-old-user-profiles.mdx"]