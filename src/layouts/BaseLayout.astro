---
interface Props {
  title: string;
  description?: string;
  pillar?: string;
  article?: {
    title: string;
    publishedAt: string;
    updatedAt?: string;
    pillar: string;
    difficulty: string;
    type: string;
    tags: string[];
  };
}

const { title, description, pillar, article } = Astro.props;

const pillarNames = {
  troubleshooting: 'Windows Troubleshooting',
  scripting: 'Scripting & Automation',
  deployment: 'Deployment & Imaging',
  security: 'Endpoint Security',
  packaging: 'App Packaging',
  career: 'Career & Craft'
};

const difficultyColors = {
  junior: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200',
  mid: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200',
  senior: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'
};

const typeLabels = {
  'war-story': 'War Story',
  'deep-dive': 'Deep Dive',
  'how-to': 'How-To',
  'script-drop': 'Script Drop',
  'error-reference': 'Error Reference',
  'opinion': 'Opinion',
  'career-guide': 'Career Guide'
};
---

<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- Primary Meta Tags -->
    <title>{title} | zakitpro</title>
    <meta name="title" content={`${title} | zakitpro`} />
    <meta name="description" content={description || 'IT Desktop Engineering Blog - Technical articles, PowerShell scripts, and career guides for endpoint engineers.'} />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={Astro.url} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:site_name" content="zakitpro" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={Astro.url} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    
    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="zakitpro RSS Feed" href="/rss.xml" />
    
    <!-- Theme Script - Blocks FOUC -->
    <script is:inline>
      const theme = (() => {
        if (typeof localStorage !== 'undefined' && localStorage.getItem('zakitpro-theme')) {
          return localStorage.getItem('zakitpro-theme');
        }
        if (window.matchMedia('(prefers-color-scheme: light)').matches) {
          return 'light';
        }
        return 'dark';
      })();
      
      if (theme === 'light') {
        document.documentElement.classList.remove('dark');
      } else {
        document.documentElement.classList.add('dark');
      }
      window.localStorage.setItem('zakitpro-theme', theme);
    </script>
  </head>
  <body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-200">
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 focus:z-50 focus:px-4 focus:py-2 focus:bg-accent focus:text-white focus:rounded-md">
      Skip to content
    </a>
    
    <!-- Header -->
    <header class="sticky top-0 z-40 w-full bg-white/80 dark:bg-gray-900/80 backdrop-blur-md border-b border-gray-200 dark:border-gray-800 transition-all duration-300" id="header">
      <div class="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between">
        <!-- Logo -->
        <a href="/" class="flex items-center gap-2 font-heading font-bold text-xl text-gray-900 dark:text-white hover:text-accent transition-colors">
          <svg class="w-8 h-8 text-accent" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
          </svg>
          <span>zakitpro</span>
        </a>
        
        <!-- Desktop Nav -->
        <nav class="hidden md:flex items-center gap-6">
          <div class="relative group">
            <button class="flex items-center gap-1 text-gray-600 dark:text-gray-300 hover:text-accent transition-colors">
              Pillars
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="absolute top-full left-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 py-2">
              {Object.entries(pillarNames).map(([id, name]) => (
                <a href={`/${id}/`} class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                  {name}
                </a>
              ))}
            </div>
          </div>
          <a href="/scripts/" class="text-gray-600 dark:text-gray-300 hover:text-accent transition-colors">Scripts</a>
          <a href="/series/" class="text-gray-600 dark:text-gray-300 hover:text-accent transition-colors">Series</a>
          <a href="/error-codes/" class="text-gray-600 dark:text-gray-300 hover:text-accent transition-colors">Error Codes</a>
          <a href="/about/" class="text-gray-600 dark:text-gray-300 hover:text-accent transition-colors">About</a>
        </nav>
        
        <!-- Right Side -->
        <div class="flex items-center gap-3">
          <!-- Search -->
          <button id="search-trigger" class="p-2 text-gray-600 dark:text-gray-300 hover:text-accent transition-colors" aria-label="Search">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
          </button>
          
          <!-- Theme Toggle -->
          <button id="theme-toggle" class="p-2 text-gray-600 dark:text-gray-300 hover:text-accent transition-colors" aria-label="Toggle theme">
            <svg class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
            </svg>
            <svg class="w-5 h-5 block dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
            </svg>
          </button>
          
          <!-- Mobile Menu -->
          <button id="mobile-menu-btn" class="md:hidden p-2 text-gray-600 dark:text-gray-300" aria-label="Menu">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
          </button>
        </div>
      </div>
      
      <!-- Mobile Menu -->
      <div id="mobile-menu" class="hidden md:hidden bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800">
        <nav class="max-w-6xl mx-auto px-4 py-4 flex flex-col gap-2">
          <span class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Pillars</span>
          {Object.entries(pillarNames).map(([id, name]) => (
            <a href={`/${id}/`} class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg">
              {name}
            </a>
          ))}
          <hr class="my-2 border-gray-200 dark:border-gray-700" />
          <a href="/scripts/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg">Scripts</a>
          <a href="/series/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg">Series</a>
          <a href="/error-codes/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg">Error Codes</a>
          <a href="/about/" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg">About</a>
        </nav>
      </div>
    </header>
    
    <!-- Main Content -->
    <main id="main-content" class="min-h-screen">
      <slot />
    </main>
    
    <!-- Footer -->
    <footer class="bg-gray-100 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-16">
      <div class="max-w-6xl mx-auto px-4 py-12">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-8 mb-8">
          <div>
            <h3 class="font-heading font-bold text-lg mb-4">zakitpro</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">IT Desktop Engineering Blog</p>
          </div>
          <div>
            <h4 class="font-semibold mb-4">Pillars</h4>
            <ul class="space-y-2 text-sm">
              {Object.entries(pillarNames).map(([id, name]) => (
                <li><a href={`/${id}/`} class="text-gray-600 dark:text-gray-400 hover:text-accent">{name}</a></li>
              ))}
            </ul>
          </div>
          <div>
            <h4 class="font-semibold mb-4">Content</h4>
            <ul class="space-y-2 text-sm">
              <li><a href="/scripts/" class="text-gray-600 dark:text-gray-400 hover:text-accent">Scripts</a></li>
              <li><a href="/series/" class="text-gray-600 dark:text-gray-400 hover:text-accent">Series</a></li>
              <li><a href="/error-codes/" class="text-gray-600 dark:text-gray-400 hover:text-accent">Error Codes</a></li>
              <li><a href="/about/" class="text-gray-600 dark:text-gray-400 hover:text-accent">About</a></li>
            </ul>
          </div>
          <div>
            <h4 class="font-semibold mb-4">Subscribe</h4>
            <ul class="space-y-2 text-sm">
              <li><a href="/rss.xml" class="text-gray-600 dark:text-gray-400 hover:text-accent">RSS Feed</a></li>
            </ul>
          </div>
        </div>
        <div class="pt-8 border-t border-gray-200 dark:border-gray-700 flex flex-col md:flex-row justify-between items-center gap-4">
          <p class="text-sm text-gray-600 dark:text-gray-400">No ads. No tracking. No fluff.</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">Â© {new Date().getFullYear()} zakitpro. All rights reserved.</p>
        </div>
      </div>
    </footer>
    
    <!-- Theme Toggle Script -->
    <script>
      const themeToggle = document.getElementById('theme-toggle');
      themeToggle?.addEventListener('click', () => {
        const isDark = document.documentElement.classList.contains('dark');
        if (isDark) {
          document.documentElement.classList.remove('dark');
          localStorage.setItem('zakitpro-theme', 'light');
        } else {
          document.documentElement.classList.add('dark');
          localStorage.setItem('zakitpro-theme', 'dark');
        }
      });
      
      // Mobile menu toggle
      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');
      mobileMenuBtn?.addEventListener('click', () => {
        mobileMenu?.classList.toggle('hidden');
      });
      
      // Keyboard shortcut for search
      document.addEventListener('keydown', (e) => {
        if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
          e.preventDefault();
          document.getElementById('search-trigger')?.click();
        }
      });
    </script>
    
    <style is:global>
      :root {
        --color-primary: #0f172a;
        --color-secondary: #1e293b;
        --color-accent: #f97316;
        --color-surface: #f1f5f9;
        --color-background: #ffffff;
      }
      
      .dark {
        --color-primary: #f8fafc;
        --color-secondary: #e2e8f0;
        --color-accent: #f97316;
        --color-surface: #1e293b;
        --color-background: #0f172a;
      }
      
      /* Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background: #94a3b8;
        border-radius: 4px;
      }
      .dark ::-webkit-scrollbar-thumb {
        background: #475569;
      }
      
      /* Code blocks */
      pre {
        position: relative;
        padding: 1rem;
        overflow-x: auto;
        border-radius: 0.5rem;
      }
      
      pre code {
        font-family: 'JetBrains Mono', Consolas, monospace;
        font-size: 0.875rem;
        line-height: 1.7;
      }
      
      /* Prose styling */
      .prose {
        max-width: 720px;
      }
      
      .prose h1, .prose h2, .prose h3, .prose h4 {
        font-family: 'Inter', system-ui, sans-serif;
        font-weight: 700;
        scroll-margin-top: 5rem;
      }
      
      .prose h1 { font-size: 2rem; }
      .prose h2 { font-size: 1.5rem; }
      .prose h3 { font-size: 1.25rem; }
      
      .prose p {
        line-height: 1.75;
        margin-bottom: 1.25rem;
      }
      
      .prose a {
        color: #f97316;
        text-decoration: underline;
      }
      
      .prose a:hover {
        color: #ea580c;
      }
      
      .prose code:not(pre code) {
        background: #f1f5f9;
        padding: 0.125rem 0.375rem;
        border-radius: 0.25rem;
        font-size: 0.875em;
      }
      
      .dark .prose code:not(pre code) {
        background: #334155;
      }
      
      .prose pre {
        margin: 1.5rem 0;
      }
      
      .prose ul, .prose ol {
        margin: 1rem 0;
        padding-left: 1.5rem;
      }
      
      .prose li {
        margin: 0.5rem 0;
      }
      
      .prose blockquote {
        border-left: 4px solid #f97316;
        padding-left: 1rem;
        font-style: italic;
        color: #64748b;
        margin: 1.5rem 0;
      }
      
      .dark .prose blockquote {
        color: #94a3b8;
      }
    </style>
  </body>
</html>
